<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catfishing Chronicles: Estonia</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f0f0;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        #game-container {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin: 20px;
            padding: 30px;
            width: 90%;
            max-width: 700px;
            text-align: center;
        }
        h1, h2 {
            color: #5a5a5a;
        }
        #character-selection, #game-content, #ending-screen {
            margin-top: 20px;
        }
        #story-text {
            text-align: left;
            margin-bottom: 25px;
            padding: 15px;
            background-color: #e9e9e9;
            border-radius: 4px;
            min-height: 100px;
        }
        .character-button, .choice-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            margin: 10px 5px;
            transition: background-color 0.3s ease;
            display: block; /* Make buttons stack vertically */
            width: calc(100% - 10px); /* Adjust width considering margins */
            box-sizing: border-box; /* Include padding and border in the element's total width and height */
        }
        .character-button:hover, .choice-button:hover {
            background-color: #0056b3;
        }
        .character-button.selected {
            background-color: #28a745;
            font-weight: bold;
        }
        #choices {
            margin-top: 20px;
            display: flex;
            flex-direction: column; /* Stack choices vertically */
            align-items: center; /* Center choices */
        }
        .char-icon {
            display: inline-block;
            margin-right: 8px;
            font-size: 1.2em;
        }
        .thought {
            font-style: italic;
            color: #666;
            margin: 10px 0;
            padding: 8px;
            background-color: #f9f9f9;
            border-left: 3px solid #ccc;
        }
        blockquote {
            margin: 15px 0;
            padding: 10px 15px;
            background-color: #f8f9fa;
            border-left: 5px solid #007bff;
            font-style: italic;
            color: #555;
        }
        blockquote footer {
            margin-top: 5px;
            font-style: normal;
            font-size: 0.9em;
            color: #777;
            text-align: right;
        }
    </style>
</head>
<body>

    <div id="game-container">
        <h1>Catfishing Chronicles: Estonia</h1>

        <div id="character-selection">
            <h2>Choose Your Character</h2>
            <p>Select a character to experience their perspective in this story about online deception.</p>
            <button class="character-button" onclick="selectCharacter('Meethexep')">
                <span class="char-icon">ğŸ›´</span> Meethexep (The Hopeful Victim)
            </button>
            <button class="character-button" onclick="selectCharacter('ChocoNiki')">
                <span class="char-icon">ğŸ­</span> Choco~Niki (The Catfisher)
            </button>
            <button class="character-button" onclick="selectCharacter('AdamMady')">
                <span class="char-icon">ğŸ¤</span> AdamMady (The Supportive Friend)
            </button>
            <button class="character-button" onclick="selectCharacter('Berishbaev')">
                <span class="char-icon">ğŸ¤”</span> Berishbaev (The Skeptical Friend)
            </button>
            <button class="character-button" onclick="selectCharacter('HappyMan')">
                <span class="char-icon">âš–ï¸</span> HappyMan (The Mediator)
            </button>
        </div>

        <div id="game-content" style="display: none;">
            <h2 id="character-name"></h2>
            <div id="story-text"></div>
            <div id="choices"></div>
        </div>

        <div id="ending-screen" style="display: none;">
            <h2>Game Over</h2>
            <div id="ending-text"></div>
            <button class="choice-button" onclick="restartGame()">Play Again?</button>
        </div>
    </div>

    <script>
        let gameState = {
            character: null,
            currentScene: null,
            flags: {} // To track choices and story progression
        };

        const characters = {
            Meethexep: { name: "Meethexep", icon: "ğŸ›´", startScene: "meeth_start" },
            ChocoNiki: { name: "Choco~Niki", icon: "ğŸ­", startScene: "niki_start" },
            AdamMady: { name: "AdamMady", icon: "ğŸ¤", startScene: "adam_start" },
            Berishbaev: { name: "Berishbaev", icon: "ğŸ¤”", startScene: "beri_start" },
            HappyMan: { name: "HappyMan", icon: "âš–ï¸", startScene: "happy_start" }
        };

        // --- STORY DATA ---
        const story = {
            // === SHARED SCENES ===
            shared_intro: {
                text: (gs) => `It's a Tuesday evening in Tallinn. Rain taps gently against the window. ${gs.character === 'Meethexep' ? 'You\'re ' : 'Meethexep is '} on his computer, electric scooter parked nearby, chatting online. The glow of the monitor illuminates a hopeful expression. His friends, AdamMady, Berishbaev, and HappyMan, are also online, aware of Meethexep's growing connection with someone named Choco~Niki.`,
                choices: [
                    { text: "Continue", nextScene: (gs) => characters[gs.character].startScene }
                ]
            },

            shared_friends_chat_early: {
                text: (gs) => `Later, in a group chat without Meethexep:
                    <br><strong>AdamMady:</strong> Guys, Meethexep seems really happy with Choco~Niki. She sounds amazing! ğŸ˜Š
                    <br><strong>Berishbaev:</strong> "She"? Has anyone actually *heard* her voice? Or seen her on video? ğŸ¤¨
                    <br><strong>HappyMan:</strong> Let's give it time. Maybe she's just shy. Important thing is Meeth is happy, right? But Berishbaev has a point, caution is good. ğŸ¤”
                    <br><strong>AdamMady:</strong> Don't be such a downer, Beri! Online relationships take time to build trust. Meeth deserves this.
                    <br><strong>Berishbaev:</strong> Trust is earned, Adam. Not blindly given based on typed words and heart emojis. Something feels off.`,
                choices: [
                    { text: "Continue the story", nextScene: (gs) => gs.flags.returnScene || characters[gs.character].startScene } // Default return or go back to char start
                ]
            },

            shared_confrontation_start: {
                text: (gs) => `Tensions have been rising. Berishbaev has become more vocal about his suspicions regarding Choco~Niki's authenticity. Meethexep, often defended by AdamMady, seems torn but mostly dismissive. HappyMan has tried to keep the peace, but it's getting harder. Tonight, things come to a head in the group chat.
                    <br><strong>Berishbaev:</strong> Meethexep, we need to talk seriously about Choco~Niki. I've been thinking, and there are too many inconsistencies.
                    <br><strong>AdamMady:</strong> Here we go again... Beri, just leave it alone! You're upsetting Meeth.
                    <br><strong>Meethexep:</strong> What inconsistencies, Berishbaev? Niki explained everything. Her webcam is broken, her mic too... bad luck, that's all. ğŸ˜¥
                    <br><strong>HappyMan:</strong> Guys, let's try to discuss this calmly. Berishbaev, what specifically worries you? Meeth, try to listen with an open mind, okay? Adam, let Beri speak.`,
                choices: [
                    { text: "Let Berishbaev state his case.", nextScene: "shared_confrontation_beri_case" }
                ]
            },

            shared_confrontation_beri_case: {
                text: (gs) => `<strong>Berishbaev:</strong> It's not just the tech issues, Meethexep. It's *always* tech issues. Never a voice call, never a video chat. The photos seem a bit *too* perfect, maybe found online? The stories sometimes change slightly. And asking for that gift card last week... it felt manipulative. It's a pattern.
                    <br><strong>AdamMady:</strong> People can have bad luck! And maybe she really needed help! You're just paranoid because you got burned that one time. ğŸ˜ 
                    <br><strong>Meethexep:</strong> She said it was for her cousin's birthday... she promised to pay me back... ğŸ˜Ÿ
                    <br><strong>Berishbaev:</strong> Did she? Meethexep, think about it. Is this how someone genuinely interested behaves? Always hiding, always needing something?
                    <br><strong>HappyMan:</strong> Okay, emotions are high. Berishbaev makes some points worth considering, Meeth. Adam, maybe focus less on attacking Beri and more on the facts presented?`,
                choices: [
                    // Choices here depend heavily on the player character
                    { text: "Respond as Meethexep", condition: (gs) => gs.character === 'Meethexep', nextScene: "meeth_confrontation_response" },
                    { text: "Respond as AdamMady", condition: (gs) => gs.character === 'AdamMady', nextScene: "adam_confrontation_response" },
                    { text: "Respond as Berishbaev", condition: (gs) => gs.character === 'Berishbaev', nextScene: "beri_confrontation_push" },
                    { text: "Respond as HappyMan", condition: (gs) => gs.character === 'HappyMan', nextScene: "happy_confrontation_mediate" },
                    { text: "Observe (Playing as Choco~Niki)", condition: (gs) => gs.character === 'ChocoNiki', nextScene: "niki_confrontation_observe" },
                ]
            },

             shared_confrontation_beri_question: {
                text: (gs) => `Berishbaev takes a deep breath, virtually speaking. The chat falls silent for a moment.
                    <br><strong>Berishbaev:</strong> Meethexep, I know this is hard to hear, and maybe I'm wrong. But I have to ask this directly, for your sake. Choco~Niki... are you secretly messaging them? Because I need to ask them something fundamental. Or maybe I should just ask you, Meethexep, to consider this: What if Choco~Niki isn't who you think 'she' is? What if... Choco~Niki... is actually a man?`,
                choices: [
                    // Choices depend on player character reacting to the bombshell question
                    { text: "React as Meethexep", condition: (gs) => gs.character === 'Meethexep', nextScene: "meeth_reaction_to_question" },
                    { text: "React as AdamMady", condition: (gs) => gs.character === 'AdamMady', nextScene: "adam_reaction_to_question" },
                    { text: "Observe the fallout (as Berishbaev)", condition: (gs) => gs.character === 'Berishbaev', nextScene: "beri_observe_fallout" },
                    { text: "Attempt damage control (as HappyMan)", condition: (gs) => gs.character === 'HappyMan', nextScene: "happy_reaction_to_question" },
                    { text: "Panic internally (as Choco~Niki)", condition: (gs) => gs.character === 'ChocoNiki', nextScene: "niki_reaction_to_question" },
                ]
            },

            // === MEETHEEP SCENES ===
            meeth_start: {
                text: (gs) => `You log in, excited. A new message from Choco~Niki! â¤ï¸
                    <blockquote>Heyyy Meeth! âœ¨ Just thinking about you! Missed chatting! How was your day zooming around Tallinn on that cool scooter? ğŸ˜‰ Hope it wasn't too rainy! â˜”ï¸ xo Niki ğŸ’–</blockquote>
                    <div class="thought">Her messages always brighten your day. She's so sweet and seems genuinely interested in your life. Estonia can feel lonely sometimes, but Niki makes it better.</div>`,
                choices: [
                    { text: "Reply enthusiastically about your day.", nextScene: "meeth_reply_enthusiastic" },
                    { text: "Ask if maybe you could try a voice call tonight.", nextScene: "meeth_ask_call_early" },
                    { text: "Mention the group chat later.", nextScene: "meeth_mention_group_chat" }
                ]
            },
            meeth_reply_enthusiastic: {
                text: (gs) => `You quickly type back: "Hey Niki! â¤ï¸ Day was good, scooter's amazing! Just got back. So good to hear from you! Missed you too! ğŸ˜Š How was your day?"
                    <br>A few minutes pass. Then...
                    <blockquote>Oh yay! Glad you had fun! My day was okayyy, kinda boring without you! ğŸ˜… Lol. Maybe we can watch a movie 'together' online later? Pick something fun! ğŸ˜˜</blockquote>
                     <div class="thought">Watching a movie 'together' means sync-starting Netflix and chatting in text. It's nice, but... part of you wishes you could actually hear her laugh.</div>`,
                choices: [
                    { text: "Agree enthusiastically to the movie.", nextScene: "meeth_movie_night" },
                    { text: "Gently ask about a voice call again.", nextScene: "meeth_ask_call_gently" }
                ]
            },
             meeth_ask_call_early: {
                text: (gs) => `You type: "Hey Niki! â¤ï¸ So good to hear from you! My day was great! Hey, I was wondering... maybe we could try a quick voice call tonight? Even just for a few minutes? Would love to actually hear your voice ğŸ˜Š"
                    <br>The reply takes longer this time.
                    <blockquote>Aww Meeth, that's so sweet! ğŸ¥° I'd LOVE to... but oh no! ğŸ˜± My headset is acting soooo weird tonight, lots of static! ğŸ˜­ And my laptop mic is broken, remember? Ugh, typical! Maybe soon tho? Promise! Let's just chat for now? ğŸ™ğŸ’–</blockquote>
                    <div class="thought">Another excuse... It stings a little, but she sounds genuinely upset about it. You don't want to push her.</div>`,
                choices: [
                    { text: "Okay, just chatting is fine.", nextScene: "meeth_accept_excuse_early" },
                    { text: "Express slight disappointment but understand.", nextScene: "meeth_slight_disappointment" },
                    { text: "Mention AdamMady thinks she sounds great.", setFlag: { adam_mentioned: true }, nextScene: "meeth_accept_excuse_early" }
                ]
            },
             meeth_accept_excuse_early: {
                text: (gs) => `You reply: "Oh okay, no problem Niki! Bad luck with the tech! ğŸ˜• Chatting is great too! ğŸ˜Š"
                     <blockquote>You're the sweetest, Meeth! ğŸ¥° Okay, so tell me everything! Did you see any cute dogs today? ğŸ¶ Lol!</blockquote>
                     <div class="thought">The conversation flows easily again, the momentary disappointment fading. She's just so easy to talk to.</div>`,
                choices: [
                    { text: "Continue chatting happily.", nextScene: "meeth_chat_continues" },
                     { text: "Check in with the friends group chat.", nextScene: "meeth_check_friends_chat" }
                ]
            },
            meeth_slight_disappointment: {
                text: (gs) => `You type: "Aw, that's a shame about the headset. Was really hoping to hear you. But okay, chatting is good too. ğŸ˜Š Let me know when it's working?"
                     <blockquote>Definitely!! I'll try to fix it ASAP! Pinky promise! ğŸ¤ Soooo... movie night instead maybe? ğŸ¬ What are you in the mood for? ğŸ¤”</blockquote>
                     <div class="thought">She seems genuine. Maybe her tech really is cursed.</div>`,
                 choices: [
                     { text: "Agree to movie night.", nextScene: "meeth_movie_night" },
                     { text: "Say you'll chat for a bit first.", nextScene: "meeth_chat_continues" }
                 ]
            },
             meeth_chat_continues: {
                text: (gs) => `The conversation continues for a while, filled with emojis, playful banter, and shared thoughts. Niki seems understanding, funny, and deeply interested in you. It's easy to forget the unanswered questions when the connection feels so strong.`,
                choices: [
                     { text: "Time passes...", nextScene: "meeth_later_evening" }
                 ]
            },
            meeth_later_evening: {
                text: (gs) => `Later that evening, you see messages popping up in the group chat with AdamMady, Berishbaev, and HappyMan.`,
                 choices: [
                     { text: "Check the group chat.", nextScene: "meeth_check_friends_chat" },
                     { text: "Ignore it for now, focus on Niki.", nextScene: "meeth_ignore_friends" } // Potential consequence: Miss warnings?
                 ]
            },
            meeth_check_friends_chat: {
                 text: (gs) => `You open the group chat. Looks like they were talking about Choco~Niki earlier.`,
                 choices: [
                     { text: "Read the backlog.", setFlag: { returnScene: "meeth_after_friends_chat" }, nextScene: "shared_friends_chat_early" }
                 ]
            },
            meeth_after_friends_chat: {
                text: (gs) => `You read the chat logs. AdamMady is supportive as always. HappyMan is balanced. But Berishbaev... his skepticism is irritating. Why can't he just be happy for you?
                    <div class="thought">Does he have a point though? No... Niki wouldn't lie like that. She's different.</div>`,
                choices: [
                    { text: "Shake off Berishbaev's doubts.", nextScene: "meeth_shake_off_doubts" },
                    { text: "Quietly wonder about the voice/video issue.", nextScene: "meeth_quiet_doubts" },
                    { text: "Ask Niki about Berishbaev's concerns.", nextScene: "meeth_ask_niki_about_doubts" } // Risky?
                ]
            },
            meeth_shake_off_doubts: {
                text: (gs) => `You close the group chat, annoyed. Berishbaev is just being negative. You focus back on your chat with Niki, pushing the doubts away. The warmth of her messages feels more real than Berishbaev's suspicions.`,
                choices: [
                    { text: "Continue chatting with Niki.", nextScene: "meeth_chat_deepens" } // Leads towards ignoring red flags
                ]
            },
             meeth_quiet_doubts: {
                 text: (gs) => `Berishbaev's words linger, unsettling you slightly. The lack of voice or video calls *is* strange. But maybe there's a simple explanation you're missing? You decide not to mention it to Niki right now, not wanting to spoil the mood.
                     <div class="thought">I'll bring it up gently later. No need to make things awkward.</div>`,
                 choices: [
                     { text: "Continue chatting with Niki, but with a small seed of doubt.", setFlag: { meeth_doubt: 1 }, nextScene: "meeth_chat_deepens" } // Slight change in progression
                 ]
             },
             meeth_ask_niki_about_doubts: {
                 text: (gs) => `You decide to cautiously bring it up with Niki. "Hey Niki, my friends were asking... they're just curious why we haven't voice or video chatted yet. Especially Berishbaev, he can be a bit skeptical lol."
                     <br>The reply comes back quickly, laden with hurt emojis.
                     <blockquote>Oh... ğŸ¥º Your friends don't trust me? That... kinda hurts, Meeth. ğŸ’” I told you about my tech issues! Do *you* not believe me either? ğŸ˜¥ Is Berishbaev trying to cause problems between us? ğŸ˜Ÿ</blockquote>
                     <div class="thought">Oh no. Now she's upset. You feel terrible.</div>`,
                 choices: [
                     { text: "Apologize profusely and reassure her.", nextScene: "meeth_reassure_niki" },
                     { text: "Defend Berishbaev slightly but still apologize.", nextScene: "meeth_defend_beri_slightly" }
                 ]
             },
            meeth_reassure_niki: {
                text: (gs) => `You quickly type back: "No, no, Niki! I believe you! 100%! I'm so sorry, I shouldn't have mentioned it. Berishbaev is just... overly protective sometimes. Please don't be upset! ğŸ™ You mean a lot to me."
                    <blockquote>Okay... ğŸ¥º *sniffle* If you say so, Meeth. I trust *you*. Just... makes me sad others doubt us. ğŸ˜” Can we just... talk about something happy now? Forget your friends for a bit? Pleeeease? ğŸ™ğŸ’–</blockquote>`,
                choices: [
                    { text: "Agree and change the subject.", setFlag: { niki_trusts_meeth: true, meeth_feels_guilty: true }, nextScene: "meeth_chat_deepens" }, // Reinforced the dynamic, avoided confrontation
                    { text: "Say you need a moment.", nextScene: "meeth_needs_moment" } // Buys time, acknowledges own feelings
                ]
            },
            meeth_chat_deepens: {
                text: (gs) => `Days turn into weeks. Your connection with Choco~Niki intensifies through text messages. You share hopes, dreams, and daily happenings. The lack of voice or video calls becomes a background hum, easily ignored most of the time. AdamMady cheers you on, Berishbaev occasionally drops skeptical comments (which you mostly ignore), and HappyMan tries to keep everyone civil. Niki sometimes mentions needing small favors - help with an online game, a small gift card for a 'friend's birthday', advice on tech issues... always with gratitude and affection.`,
                 choices: [
                     { text: "This feels right. She understands me.", nextScene: "meeth_path_deep_in" },
                     { text: "The favors are starting to feel a bit much...", condition: (gs) => gs.flags.meeth_doubt, nextScene: "meeth_favors_concern" }, // Only available if doubt flag set
                     { text: "Maybe I should insist on a video call soon.", nextScene: "meeth_insist_video" }
                 ]
            },

            // --- Confrontation Responses ---
            meeth_confrontation_response: {
                text: (gs) => `You read Berishbaev's points. They echo some of the quiet doubts you've pushed away. But admitting them feels like betraying Niki... and admitting you might have been fooled. AdamMady's defense feels comforting. HappyMan's call for calm is reasonable.
                    <div class="thought">What do I say? Defend Niki? Acknowledge Beri's points? Stay quiet?</div>`,
                choices: [
                    { text: "Defend Niki strongly. 'She explained everything!'", nextScene: "meeth_confront_defend" },
                    { text: "Acknowledge Berishbaev's points are worrying.", nextScene: "meeth_confront_acknowledge" },
                    { text: "Ask AdamMady what he *really* thinks.", nextScene: "meeth_confront_ask_adam" },
                    { text: "Stay silent, feeling overwhelmed.", nextScene: "meeth_confront_silent" }
                ]
            },
            meeth_confront_defend: {
                text: (gs) => `You type firmly: "Beri, I appreciate your concern, but Niki *has* explained these things. Bad luck happens! The gift card was a one-off, she was embarrassed to ask! You're reading too much into this. She's genuine."
                    <br><strong>AdamMady:</strong> Exactly! See, Beri? You're just trying to stir trouble.
                    <br><strong>Berishbaev:</strong> Meethexep, are you sure you're not just *wanting* to believe her explanations?`,
                choices: [
                    { text: "Double down. 'I'm sure!'", nextScene: "shared_confrontation_beri_question" }, // Leads to Beri asking the big question
                    { text: "Hesitate. 'I... I think so.'", setFlag: { meeth_wavering: true }, nextScene: "shared_confrontation_beri_question" }
                ]
            },
             meeth_confront_acknowledge: {
                 text: (gs) => `You type slowly: "Okay... Beri, I admit... some of those things have crossed my mind too. The constant tech issues are... frustrating. And maybe the gift card was a bit weird. I don't know..."
                     <br><strong>AdamMady:</strong> Meeth! Don't let him get to you! There are reasons for everything!
                     <br><strong>Berishbaev:</strong> It's okay to have doubts, Meethexep. It's important to face them.`,
                 choices: [
                     { text: "Ask Berishbaev what he thinks is really going on.", nextScene: "shared_confrontation_beri_question" }, // Prompts the big question
                     { text: "Look to HappyMan for guidance.", nextScene: "meeth_confront_ask_happy" }
                 ]
             },
             meeth_reaction_to_question: {
                 text: (gs) => `Berishbaev's question hangs in the air. "What if... Choco~Niki... is actually a man?"
                     <br>The idea hits you like a physical blow. Your mind races, trying to reconcile the sweet, feminine persona of Niki with this possibility. It feels absurd, insulting... yet, a terrifying jigsaw puzzle starts forming in your mind - the lack of voice, the excuses, the slightly off phrasing sometimes...
                     <div class="thought">No. It can't be. Berishbaev is wrong. He HAS to be wrong. But... what if?</div>`,
                 choices: [
                     { text: "Get angry. 'That's ridiculous, Berishbaev! How dare you?!'", nextScene: "meeth_ending_denial" },
                     { text: "Feel sick. 'A man? Niki? I... I don't know what to think.'", nextScene: "meeth_ending_doubt" },
                     { text: "Demand proof. 'Where is your evidence, Berishbaev?'", nextScene: "meeth_ending_demand_proof" },
                     { text: "Message Niki immediately. 'Niki, are you seeing this? Tell them!'", nextScene: "meeth_ending_ask_niki_direct" }
                 ]
             },

            // === CHOCO~NIKI SCENES ===
            niki_start: {
                text: (gs) => `You check your messages. Ah, Meethexep is online. Time to cultivate the connection. He's sweet, a little naive, and seems genuinely lonely. Perfect. You craft a message, carefully sprinkling in emojis and 'girly' slang.
                    <div class="thought">Keep it light, interested, slightly vulnerable. He likes the scooter talk. Gotta remember the details he shares. Consistency is key... mostly.</div>
                    <blockquote>Heyyy Meeth! âœ¨ Just thinking about you! Missed chatting! How was your day zooming around Tallinn on that cool scooter? ğŸ˜‰ Hope it wasn't too rainy! â˜”ï¸ xo Niki ğŸ’–</blockquote>`,
                choices: [
                    { text: "Wait for his reply.", nextScene: "niki_wait_reply" },
                    { text: "Send another message quickly, seem eager.", nextScene: "niki_double_text" }
                ]
            },
            niki_wait_reply: {
                 text: (gs) => `He replies quickly, enthusiastically. Good.
                     <blockquote>Hey Niki! â¤ï¸ Day was good, scooter's amazing! Just got back. So good to hear from you! Missed you too! ğŸ˜Š How was your day?</blockquote>
                     <div class="thought">Easy does it. Keep the focus on him, seem a bit bored without him, suggest an activity that requires no voice/video.</div>
                     You type: <blockquote>Oh yay! Glad you had fun! My day was okayyy, kinda boring without you! ğŸ˜… Lol. Maybe we can watch a movie 'together' online later? Pick something fun! ğŸ˜˜</blockquote>`,
                 choices: [
                     { text: "Wait for his response.", nextScene: "niki_wait_movie_response" }
                 ]
             },
             niki_handle_call_request: {
                 text: (gs) => `He asks about a voice call. Predictable. Time for the standard excuses. Need to sound disappointed but firm.
                     <div class="thought">Broken headset, bad laptop mic, maybe throw in some 'embarrassment' about tech failures. Layer it up.</div>
                      You type: <blockquote>Aww Meeth, that's so sweet! ğŸ¥° I'd LOVE to... but oh no! ğŸ˜± My headset is acting soooo weird tonight, lots of static! ğŸ˜­ And my laptop mic is broken, remember? Ugh, typical! Maybe soon tho? Promise! Let's just chat for now? ğŸ™ğŸ’–</blockquote>`,
                 choices: [
                     { text: "Hope he buys it.", nextScene: "niki_wait_call_response" }
                 ]
             },
              niki_wait_call_response: {
                  text: (gs) => `He seems to accept the excuse, maybe with a hint of disappointment, maybe not. As long as he drops it for now.
                      <div class="thought">Need to steer the conversation back to safe territory quickly. Keep him engaged.</div>
                      If he seems disappointed: <blockquote>Definitely!! I'll try to fix it ASAP! Pinky promise! ğŸ¤ Soooo... movie night instead maybe? ğŸ¬ What are you in the mood for? ğŸ¤”</blockquote>
                      If he accepts readily: <blockquote>You're the sweetest, Meeth! ğŸ¥° Okay, so tell me everything! Did you see any cute dogs today? ğŸ¶ Lol!</blockquote>`,
                  choices: [
                      { text: "Continue the charade.", nextScene: "niki_continue_charade" }
                  ]
              },
              niki_continue_charade: {
                   text: (gs) => `You keep the conversation flowing, mimicking interest, sharing carefully curated (or fabricated) details about 'your' life. It's a performance. Sometimes tiring, sometimes exhilarating when he hangs on your every word. You occasionally test the waters, asking for small favors, gauging his willingness to please. The friends are a background noise, Berishbaev being the only potential threat, but Meethexep seems easy to reassure.`,
                   choices: [
                       { text: "Maintain the illusion.", nextScene: "niki_long_term_plan" },
                       { text: "Consider escalating the requests.", nextScene: "niki_consider_escalation" }, // Riskier path
                       { text: "Feel a pang of guilt.", condition: (gs) => !gs.flags.niki_no_guilt, nextScene: "niki_feel_guilt" } // Maybe a rare moment of reflection?
                   ]
               },
               niki_long_term_plan: {
                   text: (gs) => `Weeks pass. The connection deepens, purely text-based. Meethexep is hooked. His friends are mostly non-issues, easily managed through Meethexep's affection for you. You keep feeding him the persona he wants, the sweet, slightly damsel-in-distress Niki. It's working perfectly.
                       <div class="thought">Just need to keep Berishbaev managed. Maybe drop a hint to Meethexep that Berishbaev makes you 'uncomfortable'?</div>`,
                   choices: [
                       { text: "Keep things steady.", nextScene: "niki_status_quo" },
                       { text: "Subtly poison Meethexep against Berishbaev.", nextScene: "niki_poison_beri" }
                   ]
               },
               // --- Confrontation Response ---
               niki_confrontation_observe: {
                   text: (gs) => `You're not in the group chat directly, but Meethexep messages you, worried, relaying the conversation. Berishbaev is laying out his suspicions. AdamMady is defending you. HappyMan is trying to mediate. Meethexep sounds torn.
                       <div class="thought">Okay, standard procedure. Play the victim. Make Meethexep feel guilty for doubting or for his friends doubting. Reinforce his trust in *you*.</div>`,
                   choices: [
                       { text: "Send Meethexep a message expressing hurt and confusion.", nextScene: "niki_confront_play_victim" },
                       { text: "Tell Meethexep Berishbaev is just jealous or mistaken.", nextScene: "niki_confront_blame_beri" },
                       { text: "Wait to see how Meethexep handles it first.", nextScene: "niki_confront_wait" }
                   ]
               },
               niki_reaction_to_question: {
                   text: (gs) => `Meethexep frantically messages you: "Niki! Berishbaev just asked... he asked if you're... a man! In the group chat! Tell me it's not true! Please!"
                       <br>Your blood runs cold. The direct question. This is the moment of maximum danger. One wrong move and the whole thing collapses.
                       <div class="thought">Deny. Deny vehemently. Feign outrage, hurt. Turn it back on Berishbaev. Make Meethexep choose.</div>`,
                   choices: [
                       { text: "Respond with shock and tears (emojis). 'A MAN?! Me?! How could he?! ğŸ˜­ğŸ’”'", nextScene: "niki_ending_outrage" },
                       { text: "Block Meethexep and disappear.", nextScene: "niki_ending_ghost" }, // The coward's way out
                       { text: "Try a complex lie. 'My cousin sometimes uses my account!?'", nextScene: "niki_ending_complex_lie" }, // Risky
                       { text: "Hesitate... maybe confess partially?", nextScene: "niki_ending_partial_confess" } // Extremely unlikely for a dedicated catfisher, but an option
                   ]
               },

            // === ADAMMADY SCENES ===
            adam_start: {
                text: (gs) => `You see Meethexep is online, probably chatting with Choco~Niki again. He seems so much happier lately. It's great! Niki sounds like a really sweet girl from what Meeth says. You pop into the group chat.
                    <div class="thought">Meeth deserves someone nice. Hope Berishbaev doesn't start poking holes in it like he always does.</div>
                    You type: "Hey guys! Meeth seems really smitten with Niki, huh? So cool! ğŸ˜Š"`,
                choices: [
                    { text: "See who replies.", nextScene: "adam_wait_reply" }
                ]
            },
            adam_wait_reply: {
                 text: (gs) => `Berishbaev replies almost immediately, skepticism radiating even through text. HappyMan tries to be diplomatic. Typical.
                     <br><strong>Berishbaev:</strong> "Cool"? Or concerning? Still no voice call, Adam? ğŸ¤¨
                     <br><strong>HappyMan:</strong> Hey Adam! Yeah, he does seem happy. Let's hope for the best. Cautious optimism? ğŸ¤”
                      <div class="thought">Why can't Berishbaev just be supportive for once?</div>`,
                 choices: [
                     { text: "Defend Niki and Meethexep.", nextScene: "adam_defend_early" },
                     { text: "Agree with HappyMan, but lean positive.", nextScene: "adam_agree_happy" }
                 ]
             },
             adam_defend_early: {
                 text: (gs) => `You reply to Berishbaev: "Don't be such a downer, Beri! Online relationships take time to build trust. Maybe she's shy or has tech issues like Meeth said. Give them a break! Meeth deserves this."
                     <br><strong>Berishbaev:</strong> Trust is earned, Adam. Not assumed based on wishful thinking.
                     <div class="thought">He's impossible sometimes.</div>`,
                 choices: [
                     { text: "Leave the chat for now.", nextScene: "adam_later" },
                     { text: "Privately message Meethexep encouragement.", nextScene: "adam_pm_meeth" }
                 ]
             },
             adam_later: {
                  text: (gs) => `Time passes. You continue to support Meethexep's relationship with Niki, offering encouragement and dismissing Berishbaev's concerns whenever they arise. HappyMan remains neutral, trying to keep the peace. You genuinely believe Niki is good for Meethexep.`,
                  choices: [
                      { text: "The bond between Meeth and Niki seems strong.", nextScene: "adam_status_quo" },
                      { text: "Maybe ask Meethexep gently if he's *sure* about Niki.", nextScene: "adam_gentle_check" } // Slight doubt creeps in?
                  ]
              },
             // --- Confrontation Response ---
             adam_confrontation_response: {
                 text: (gs) => `Berishbaev is attacking Niki again, listing his 'evidence'. Meethexep sounds uncertain. This isn't right! You need to stand up for Meethexep and Niki.
                     <div class="thought">Beri is being paranoid and cruel. Niki wouldn't do that!</div>`,
                 choices: [
                     { text: "Attack Berishbaev's motives. 'You're just jealous!'", nextScene: "adam_confront_attack_beri" },
                     { text: "Reassure Meethexep. 'Don't listen to him, Meeth!'", nextScene: "adam_confront_reassure_meeth" },
                     { text: "Try to poke holes in Berishbaev's 'evidence'.", nextScene: "adam_confront_refute_beri" }
                 ]
             },
             adam_reaction_to_question: {
                  text: (gs) => `Berishbaev actually asked it. "Is Choco~Niki... a man?" You stare at the screen, shocked. That's the most absurd, offensive thing you've ever heard! Poor Niki! Poor Meethexep!
                      <div class="thought">This is slander! Berishbaev has gone too far!</div>`,
                  choices: [
                      { text: "Explode at Berishbaev. 'THAT'S A HORRIBLE THING TO SAY!'", nextScene: "adam_ending_outrage" },
                      { text: "Immediately defend Niki's character.", nextScene: "adam_ending_defend_niki" },
                      { text: "Tell Meethexep not to believe a word of it.", nextScene: "adam_ending_support_meeth" }
                  ]
              },


            // === BERISHBAEV SCENES ===
            beri_start: {
                text: (gs) => `You see Meethexep online, likely engrossed in his chat with 'Choco~Niki'. A familiar sense of unease settles in your gut. You've seen scams, heard stories... and this situation has several red flags. AdamMady's naive enthusiasm doesn't help. You join the group chat.
                    <div class="thought">Something isn't right here. Too many convenient excuses, too much idealization from Meethexep. Need to keep an eye on this.</div>
                    You see AdamMady's message: "Hey guys! Meeth seems really smitten with Niki, huh? So cool! ğŸ˜Š"`,
                choices: [
                    { text: "Immediately counter with skepticism. 'Cool? Or concerning?'", nextScene: "beri_counter_adam" },
                    { text: "Ask a pointed question. 'Has anyone actually heard her voice yet?'", nextScene: "beri_ask_voice" },
                    { text: "Wait and observe for now.", nextScene: "beri_observe_early" }
                ]
            },
             beri_counter_adam: {
                 text: (gs) => `You type back: ""Cool"? Or concerning? Still no voice call, Adam? ğŸ¤¨"
                     <br>AdamMady predictably gets defensive. HappyMan tries to smooth things over.
                     <br><strong>AdamMady:</strong> Don't be such a downer, Beri! Online relationships take time...
                     <br><strong>HappyMan:</strong> ...Let's hope for the best. Cautious optimism? ğŸ¤”
                     <div class="thought">Optimism won't protect Meethexep if this goes wrong. Caution is necessary.</div>`,
                 choices: [
                     { text: "Reiterate the importance of trust being earned.", nextScene: "beri_earned_trust" },
                     { text: "Let it go for now, but make a mental note.", nextScene: "beri_later" }
                 ]
             },
             beri_earned_trust: {
                  text: (gs) => `You reply to AdamMady: "Trust is earned, Adam. Not blindly given based on typed words and heart emojis. Something feels off."
                      <div class="thought">He won't listen now. But maybe the seed is planted. Need more concrete evidence or inconsistencies.</div>`,
                  choices: [
                      { text: "Disengage from the chat for now.", nextScene: "beri_later" },
                      { text: "Privately message HappyMan with your concerns.", nextScene: "beri_pm_happy" }
                  ]
              },
              beri_later: {
                   text: (gs) => `Weeks pass. You watch Meethexep get deeper into this online relationship. You notice the small inconsistencies he dismisses, the convenient tech failures Niki always seems to have, the occasional request for small favors. AdamMady remains blindly supportive, HappyMan remains diplomatic. Your suspicion grows.
                       <div class="thought">It's not just shyness. It's evasion. The pattern is classic catfishing. I need to make Meethexep see it, even if it hurts.</div>`,
                   choices: [
                       { text: "Start compiling a list of red flags.", setFlag: { beri_has_list: true }, nextScene: "beri_compile_flags" },
                       { text: "Try talking to Meethexep directly, gently.", nextScene: "beri_talk_meeth_direct" },
                       { text: "Wait for a bigger slip-up from Niki.", nextScene: "beri_wait_slipup" }
                   ]
               },
               beri_compile_flags: {
                    text: (gs) => `You start noting down the specific instances:
                        <ul>
                            <li>No voice calls (multiple excuses: broken mic, static, bad connection, shyness).</li>
                            <li>No video calls (broken webcam, bad lighting, 'not feeling cute').</li>
                            <li>Photos seem generic / possibly sourced online (need to check this).</li>
                            <li>Asking for gift cards/favors, even small ones.</li>
                            <li>Inconsistent details in stories sometimes.</li>
                            <li>Overly perfect, almost stereotypical 'girly' persona online.</li>
                        </ul>
                        <div class="thought">The evidence is circumstantial, but the pattern is strong. How to present this without Meethexep shutting down completely?</div>`,
                    choices: [
                        { text: "Present the list in the group chat soon.", nextScene: "beri_prep_confrontation" },
                        { text: "Try to gather more definitive proof first (e.g., reverse image search).", nextScene: "beri_seek_proof" }
                    ]
                },
             // --- Confrontation Response ---
             beri_confrontation_push: {
                 text: (gs) => `Meethexep is wavering, AdamMady is deflecting. HappyMan is trying but isn't pushing hard enough. It's time to cut through the excuses. You have your list of concerns.
                     <div class="thought">They need to face the possibility, however unpleasant. Be direct, but frame it as concern for Meethexep.</div>`,
                 choices: [
                     { text: "State the pattern clearly and firmly.", nextScene: "beri_confront_state_pattern" },
                     { text: "Ask Meethexep directly: 'Do YOU truly believe her excuses?'", nextScene: "beri_confront_ask_meeth" },
                     { text: "Prepare to ask the ultimate question.", nextScene: "shared_confrontation_beri_question" }
                 ]
             },
             beri_observe_fallout: {
                   text: (gs) => `You've asked the question: "Is Choco~Niki... actually a man?" The chat explodes or falls into stunned silence. Meethexep's reaction is key. AdamMady is likely furious. HappyMan is probably trying to process.
                       <div class="thought">This was necessary. It might destroy the friendship, but Meethexep needed to hear the possibility out loud. Now... wait for the fallout.</div>`,
                   choices: [
                       { text: "Observe Meethexep's reaction.", nextScene: "beri_ending_observe" },
                       { text: "Address AdamMady's inevitable anger.", nextScene: "beri_ending_address_adam" },
                       { text: "State you have reasons for asking.", nextScene: "beri_ending_justify" }
                   ]
               },


            // === HAPPYMAN SCENES ===
            happy_start: {
                text: (gs) => `You see the usual suspects online: Meethexep (likely talking to Niki), AdamMady, and Berishbaev. You anticipate the familiar dynamic: Meethexep happy, AdamMady supportive, Berishbaev skeptical. You hope things stay calm tonight. You enter the group chat.
                    <div class="thought">Meethexep's happiness is good, but Berishbaev's caution isn't entirely unfounded in the online world. Best to stay balanced.</div>
                    AdamMady posts: "Hey guys! Meeth seems really smitten with Niki, huh? So cool! ğŸ˜Š"
                    Berishbaev replies: ""Cool"? Or concerning? Still no voice call, Adam? ğŸ¤¨"`,
                choices: [
                    { text: "Offer a balanced perspective. 'He seems happy, let's hope for the best.'", nextScene: "happy_offer_balance" },
                    { text: "Gently probe Meethexep's happiness. 'How's it *really* going, Meeth?' (Requires PM)", nextScene: "happy_pm_meeth" },
                    { text: "Stay quiet and see how it plays out.", nextScene: "happy_observe_early" }
                ]
            },
            happy_offer_balance: {
                 text: (gs) => `You type: "Hey Adam! Yeah, he does seem happy. Let's hope for the best. Cautious optimism? ğŸ¤” Beri raises fair points about caution online, but let's give Meeth space too."
                     <br><strong>AdamMady:</strong> Thanks, HappyMan! At least someone is reasonable (unlike Beri!).
                     <br><strong>Berishbaev:</strong> Caution isn't negativity, HappyMan. It's realism.
                     <div class="thought">Okay, diffused slightly. Need to keep bridging the gap between Adam's enthusiasm and Beri's suspicion.</div>`,
                 choices: [
                     { text: "Suggest changing the topic.", nextScene: "happy_change_topic" },
                     { text: "Acknowledge both points again.", nextScene: "happy_acknowledge_both" },
                     { text: "Let the conversation fade.", nextScene: "happy_later" }
                 ]
             },
             happy_later: {
                   text: (gs) => `Weeks go by. The dynamic remains the same. Meethexep seems happy but maybe a little stressed by Berishbaev's questions. AdamMady doubles down on support. Berishbaev gets more insistent. You find yourself mediating more often, trying to prevent blow-ups.
                       <div class="thought">It's getting tense. Berishbaev seems convinced something is wrong. AdamMady refuses to see it. Meethexep is caught in the middle. This can't continue indefinitely.</div>`,
                   choices: [
                       { text: "Try to talk to Berishbaev and AdamMady separately.", nextScene: "happy_talk_separately" },
                       { text: "Suggest a group 'intervention' (risky).", nextScene: "happy_suggest_intervention" },
                       { text: "Hope it resolves itself (passive).", nextScene: "happy_wait_resolve" }
                   ]
               },
            // --- Confrontation Response ---
            happy_confrontation_mediate: {
                text: (gs) => `Berishbaev has laid out his concerns. AdamMady immediately jumped to Niki's defense. Meethexep seems shaken. This is delicate. Need to validate concerns without assigning blame, and keep lines of communication open.
                    <div class="thought">Acknowledge Beri's points are worth thinking about. Ask Adam to focus on the points, not the person. Encourage Meeth to consider things calmly.</div>`,
                choices: [
                    { text: "Validate Beri's points gently. 'Those are valid things to wonder about...'", nextScene: "happy_confront_validate_beri" },
                    { text: "Ask AdamMady to calm down. 'Adam, let's hear him out.'", nextScene: "happy_confront_calm_adam" },
                    { text: "Ask Meethexep how *he* feels about these points.", nextScene: "happy_confront_ask_meeth" },
                    { text: "Try to de-escalate generally. 'Okay everyone, deep breaths.'", nextScene: "happy_confront_deescalate" }
                ]
            },
            happy_reaction_to_question: {
                 text: (gs) => `The question lands like a bomb: "Is Choco~Niki... a man?" Silence, then likely chaos. AdamMady will be furious, Meethexep devastated or defensive, Berishbaev resolute.
                     <div class="thought">Okay. Crisis point. Need to manage the immediate explosion. Prevent personal attacks. Focus on Meethexep's well-being, regardless of the truth.</div>`,
                 choices: [
                     { text: "Immediately try to calm everyone. 'WHOA! Okay, let's not attack each other!'", nextScene: "happy_ending_calm_down" },
                     { text: "Focus on Meethexep. 'Meeth, are you okay? This is a lot.'", nextScene: "happy_ending_focus_meeth" },
                     { text: "Ask Berishbaev calmly why he's so certain.", nextScene: "happy_ending_ask_beri_why" },
                     { text: "Acknowledge the gravity. 'That's a serious accusation, Beri.'", nextScene: "happy_ending_acknowledge_gravity" }
                 ]
             },


            // === ENDINGS ===
            // Meethexep Endings
            meeth_ending_denial: {
                text: () => `You explode in the chat. "THAT'S A LIE, BERISHBAEV! Niki is the sweetest person I know! How DARE you suggest something so vile?! Are you trying to ruin my happiness?!" You block Berishbaev, maybe even lash out at HappyMan for not shutting him down sooner. You cling to Niki, needing her reassurance more than ever. <br><br><strong>Ending: Willful Ignorance.</strong> You choose to believe the fantasy. The friendship with Berishbaev is likely broken, and strains appear with HappyMan. You remain vulnerable to Choco~Niki's manipulation, potentially leading to deeper emotional or even financial harm down the line. The truth remains buried, for now.`,
                choices: [{ text: "The End.", nextScene: "END" }]
            },
            meeth_ending_doubt: {
                text: () => `A wave of nausea washes over you. "A man...?" you type weakly. The pieces Berishbaev mentioned, the excuses, the lack of voice... it suddenly seems terrifyingly plausible. You feel confused, hurt, and deeply uncertain. "I... I need some time. I don't know what to believe." You log off abruptly. <br><br><strong>Ending: Cracks in the Foundation.</strong> You haven't accepted the truth yet, but the seed of doubt is firmly planted. You'll likely withdraw from Niki and your friends for a while to process. Your path forward is uncertain â€“ you might eventually seek proof, confront Niki, or try to bury the doubt again. The immediate relationship is fractured, and your trust is shaken.`,
                choices: [{ text: "The End.", nextScene: "END" }]
            },
            meeth_ending_demand_proof: {
                 text: () => `Panic mixes with anger. "Proof, Berishbaev! You can't just say something like that without proof! Show me! Where's your evidence?!" You challenge him, perhaps hoping he has nothing concrete, that this is just suspicion. <br><br><strong>Ending: Seeking Confirmation.</strong> Your reaction demands evidence. If Berishbaev has gathered proof (like reverse image search results, or logs of Niki contradicting herself), you might be forced to confront the truth. If he hasn't, you might dismiss his claims, but the question will linger. The outcome depends on the strength of the 'evidence' and your willingness to see it.`,
                 choices: [{ text: "The End.", nextScene: "END" }]
             },
             meeth_ending_ask_niki_direct: {
                 text: () => `Your fingers tremble as you open a private chat with Niki. "Niki, please tell me it's not true. Berishbaev is saying... he's saying you're a man. Please, just tell me he's wrong. Send a voice note? A picture right now? Anything!" <br><br><strong>Ending: Confronting the Source.</strong> You put the question directly to Choco~Niki. Their response (or lack thereof) will likely determine the outcome. They might double down on lies, lash out, or simply disappear (ghost you). This forces the issue but leaves you vulnerable to further manipulation or sudden abandonment.`,
                 choices: [{ text: "The End.", nextScene: "END" }]
             },

            // Choco~Niki Endings
             niki_ending_outrage: {
                 text: () => `You respond to Meethexep with a torrent of hurt and indignant messages. "A MAN?! Meeth, how could you even ASK that?! ğŸ˜­ After everything? Berishbaev is poisoning you against me! I feel so betrayed! ğŸ’”ğŸ’” I thought you TRUSTED me!" You might threaten to leave, playing on his guilt. <br><br><strong>Ending: The Manipulator Doubles Down.</strong> You use emotional manipulation to deflect the accusation. If Meethexep is prone to guilt or denial, this might work, preserving the charade but likely damaging his friendships. If he stands firm or demands proof, the facade may crumble anyway.`,
                 choices: [{ text: "The End.", nextScene: "END" }]
             },
             niki_ending_ghost: {
                  text: () => `Panic sets in. It's over. The direct accusation means the game is up, or too risky to continue. You read Meethexep's message, your heart pounding. Then, you click 'Block'. You change your username, delete the account, or simply vanish into the digital ether. <br><br><strong>Ending: The Disappearing Act.</strong> You cut all ties abruptly, leaving Meethexep with unanswered questions, confusion, and pain. You escape consequences but offer no closure or explanation. The impact on Meethexep is profound and negative.`,
                  choices: [{ text: "The End.", nextScene: "END" }]
              },
              niki_ending_complex_lie: {
                  text: () => `You scramble for an explanation. "OMG Meeth! ğŸ˜± That's CRAZY! Maybe... maybe my annoying cousin used my account sometimes?? He's such a jerk! That must be what Berishbaev heard! It wasn't ME! I swear! ğŸ™" <br><br><strong>Ending: The Desperate Gambit.</strong> You attempt a convoluted lie. It's unlikely to hold up under scrutiny, especially if Berishbaev has been thorough. This might buy you moments, but it's a high-risk strategy that often unravels, making the eventual reveal even worse.`,
                  choices: [{ text: "The End.", nextScene: "END" }]
              },
               niki_ending_partial_confess: { // Less common catfisher ending
                   text: () => `A strange mix of panic and... exhaustion? Maybe a sliver of guilt? You hesitate. "Meethexep... it's... complicated. Okay? Yes, I'm not exactly who I said I was. I am a guy. I'm sorry. I was lonely... it just got out of hand." <br><br><strong>Ending: The Reluctant Confession.</strong> You admit the truth, perhaps partially, driven by pressure or a rare moment of conscience. This leads to a different kind of fallout â€“ dealing with Meethexep's reaction to the confirmed betrayal, potential anger from friends, and your own motivations being exposed.`,
                   choices: [{ text: "The End.", nextScene: "END" }]
               },

            // AdamMady Endings
            adam_ending_outrage: {
                 text: () => `You erupt in the chat. "BERISHBAEV, YOU ARE UNBELIEVABLE! That is the lowest, most disgusting accusation! Apologize to Meethexep and Niki RIGHT NOW! How could you be so cruel?!" You vehemently defend Niki, possibly attacking Berishbaev personally. <br><br><strong>Ending: Blind Loyalty.</strong> Your loyalty to Meethexep (and your idealized image of Niki) overrides any critical thinking. You damage your relationship with Berishbaev and potentially HappyMan. You actively help Meethexep stay in denial, hindering his ability to see the truth.`,
                 choices: [{ text: "The End.", nextScene: "END" }]
             },
              adam_ending_defend_niki: {
                  text: () => `"That's impossible! Niki is kind, sweet, funny... everything Meeth said! Berishbaev, you're projecting your own issues or you've completely misunderstood something! There's NO WAY she's a man!" You focus on Niki's perceived character. <br><br><strong>Ending: Character Witness for a Phantom.</strong> You appeal to the persona Niki created. This defense relies entirely on the illusion being true. When (or if) the truth comes out, your judgment will be severely questioned, and you'll have to face your own naivety.`,
                  choices: [{ text: "The End.", nextScene: "END" }]
              },
              adam_ending_support_meeth: {
                  text: () => `You focus on Meethexep. "Meeth, don't listen to this poison. Berishbaev is trying to hurt you. Niki wouldn't lie like that. We know her. Just block him, ignore him. I'm here for you." <br><br><strong>Ending: Enabling Denial.</strong> You prioritize Meethexep's immediate comfort over the potential, painful truth. You actively encourage him to dismiss the warning signs and isolate himself from dissenting voices. While well-intentioned, this ultimately harms Meethexep in the long run.`,
                  choices: [{ text: "The End.", nextScene: "END" }]
              },

            // Berishbaev Endings
             beri_ending_observe: {
                 text: () => `You watch the reactions unfold after dropping the bombshell question. Meethexep's shock, AdamMady's fury, HappyMan's attempt to control the chaos. You stay silent for a moment, letting the weight of the possibility sink in. <br><br><strong>Ending: The Catalyst.</strong> You set the confrontation in motion but step back to let the others react. The outcome depends on their choices now. You might be vindicated, ostracized, or see a painful truth slowly dawn. Your role was to force the issue into the open.`,
                 choices: [{ text: "The End.", nextScene: "END" }]
             },
             beri_ending_address_adam: {
                  text: () => `As AdamMady explodes, you respond calmly but firmly. "Adam, this isn't about jealousy or cruelty. It's about inconsistencies and red flags that point to deception. I asked the question because the possibility is real and Meethexep needs to consider it." <br><br><strong>Ending: Standing Ground.</strong> You refuse to be baited by AdamMady's anger and stand by your reasoning. This might solidify the rift with Adam but shows HappyMan and possibly Meethexep that your accusation wasn't malicious, potentially making them more receptive to the idea.`,
                  choices: [{ text: "The End.", nextScene: "END" }]
              },
              beri_ending_justify: {
                   text: () => `Before the chaos fully erupts, you add, "I wouldn't ask something like that lightly. There's a pattern: no voice, no video, convenient excuses, the photos, the requests for favors... It all points towards catfishing. The gender question is the logical conclusion of those doubts." <br><br><strong>Ending: Laying Out the Case.</strong> You immediately follow up your question with the reasoning behind it. This provides context and evidence, making it harder to dismiss as a random attack. It forces others to confront the pattern, not just the shocking question itself.`,
                   choices: [{ text: "The End.", nextScene: "END" }]
               },

             // HappyMan Endings
             happy_ending_calm_down: {
                 text: () => `You immediately jump in. "WHOA! Okay, everyone take a breath! Berishbaev, that's a huge accusation. Adam, shouting won't help. Meethexep, this must be shocking. Let's try not to attack each other right now." <br><br><strong>Ending: The Firefighter.</strong> You prioritize de-escalation above all else. While potentially preventing an immediate meltdown, it might also delay confronting the actual issue. Your focus is on managing the conflict rather than finding the truth at this moment.`,
                 choices: [{ text: "The End.", nextScene: "END" }]
             },
             happy_ending_focus_meeth: {
                 text: () => `Seeing the potential impact, you direct your attention to Meethexep. "Meeth, are you okay? That's a heavy thing to hear. Whatever is going on, your well-being is the priority. Forget the arguments for a second." <br><br><strong>Ending: Prioritizing the Victim.</strong> You center Meethexep's emotional state. This is empathetic but might be interpreted as taking his side or avoiding the difficult question. It provides immediate support but might not push towards resolution.`,
                 choices: [{ text: "The End.", nextScene: "END" }]
             },
             happy_ending_ask_beri_why: {
                 text: () => `You turn to Berishbaev, keeping your tone level. "Beri, that's an incredibly serious thing to suggest. You must have strong reasons for thinking that. Can you explain calmly why you believe this?" <br><br><strong>Ending: Seeking Clarification.</strong> You act as a neutral arbiter, asking for justification. This validates the seriousness of the claim while demanding evidence, moving the conversation towards facts (if Beri has them) rather than just emotional reactions.`,
                 choices: [{ text: "The End.", nextScene: "END" }]
             },
             happy_ending_acknowledge_gravity: {
                 text: () => `You acknowledge the weight of Berishbaev's words. "Okay... Beri, understand that accusing someone of this, of being a man pretending to be Niki... that's massive. Adam, Meeth, it's understandable to be shocked or angry. Let's process this carefully." <br><br><strong>Ending: Validating Emotions, Centering the Issue.</strong> You validate everyone's potential reactions while emphasizing the seriousness of the accusation itself. This attempts to create space for discussion by acknowledging the emotional impact and the factual claim simultaneously.`,
                 choices: [{ text: "The End.", nextScene: "END" }]
             },

            // === SHARED ENDING SCENES ===
            shared_ending_beri_vindicated: {
                text: () => `The truth is out. Choco~Niki is indeed not who they claimed to be. Meethexep is hurt and confused, AdamMady is shocked and perhaps starting to question his earlier stance. HappyMan tries to mediate the fallout. Berishbaev, while not happy about the situation, feels a grim sense of vindication. The group dynamic is changed, trust is broken, but a potential crisis was averted. <br><br><strong>Ending: Berishbaev's Vindication.</strong> Berishbaev's skepticism was proven correct. While the situation is painful, his intervention prevented further deception and potential harm to Meethexep. The friendship group will need to navigate the aftermath and rebuild trust.`,
                choices: [{ text: "The End.", nextScene: "END" }]
            },
            shared_ending_catfisher_escapes: {
                text: () => `Choco~Niki disappears, blocks everyone, or vehemently denies everything and manages to sow further confusion and distrust among the friends. The truth remains uncertain for Meethexep, but the sense of betrayal lingers. AdamMady might remain in denial, HappyMan is left trying to pick up the pieces, and Berishbaev feels frustrated by the unresolved situation. <br><br><strong>Ending: Catfisher Escapes Unaccountable.</strong> Choco~Niki avoids true exposure, leaving Meethexep and his friends in a state of unresolved conflict and lingering doubt. The group dynamic is strained, and Meethexep's vulnerability might remain unaddressed.`,
                choices: [{ text: "The End.", nextScene: "END" }]
            },

            // === MEETHEEP SCENES ENDINGS ===
            meeth_movie_night: {
                text: (gs) => `You and Niki 'watch' a movie together online, chatting throughout. It's a pleasant evening, filled with lighthearted banter and virtual closeness. The doubts about her voice and video fade into the background as you enjoy the connection you have. <div class="thought">Maybe I'm worrying too much. She's really great.</div>`,
                choices: [
                    { text: "Enjoy the movie night.", nextScene: "meeth_chat_deepens" }
                ]
            },
            meeth_path_deep_in: {
                text: (gs) => `You fully embrace the relationship with Choco~Niki, dismissing any lingering doubts or external warnings. Her messages become a central part of your day, her requests feel like opportunities to show your affection. You're falling deeper into the illusion, convinced you've found a genuine connection.`,
                choices: [
                    { text: "Time moves forward...", nextScene: "shared_confrontation_start" } // Move towards confrontation arc
                ]
            },
            meeth_favors_concern: {
                text: (gs) => `The small favors Niki asks for are becoming more frequent, or slightly larger. A game item, another gift card 'for a friend', help with 'urgent' online purchases. Each request is accompanied by sweet words and gratitude, making it hard to refuse, but a nagging feeling starts to grow. <div class="thought">Is this... normal? Are these just tests of my generosity?</div>`,
                choices: [
                    { text: "Continue fulfilling the favors, hoping it's just generosity.", nextScene: "meeth_path_deeper_favors" }, // Path of continued manipulation
                    { text: "Start questioning the favors gently with Niki.", nextScene: "meeth_question_favors_gently" } // Path of potential confrontation
                ]
            },
            meeth_path_deeper_favors: {
                text: (gs) => `You keep fulfilling Niki's requests, rationalizing them as acts of love and support. The favors become more demanding, both in frequency and value. You might start stretching your budget, or even borrowing small amounts to help her 'out'. The line between 'generosity' and 'exploitation' blurs. <div class="thought">She really needs my help, and she appreciates it so much. It's worth it to make her happy.</div>`,
                choices: [
                    { text: "Continue down this path...", nextScene: "shared_confrontation_start" } // Move towards confrontation, likely triggered by friends' concern
                ]
            },
            meeth_question_favors_gently: {
                text: (gs) => `You decide to cautiously ask Niki about the favors. "Hey Niki, you know I'm happy to help, but... are you sure everything is okay? You've needed a few things lately, just wanted to check in." <br>Her response is swift and defensive. <blockquote>Meeth! ğŸ¥º Are you saying you *mind* helping me? Is it too much for you? ğŸ˜¥ I thought you *cared* about me! Maybe I'm bothering you... ğŸ’”</blockquote> <div class="thought">Oh no, she's upset again. I didn't mean to make her feel bad.</div>`,
                choices: [
                    { text: "Immediately apologize and reassure her it's not a problem.", nextScene: "meeth_reassure_favors" },
                    { text: "Try to gently re-explain your concern.", nextScene: "meeth_re-explain_concern" }
                ]
            },
            meeth_reassure_favors: {
                text: (gs) => `You quickly type: "No, no, Niki! Not at all! I love helping you! I just wanted to make sure *you* were okay, that's all! Please don't be upset! ğŸ™ I'll always be there for you." <blockquote>Oh Meeth! ğŸ¥° You're so sweet! Thank you! It's just been a bit of a tough time lately, you're such a ray of sunshine! âœ¨ğŸ’– Okay, subject change? ğŸ˜‰ Tell me more about your scooter adventures! ğŸ›´"</blockquote> <div class="thought">Phew, crisis averted. She's happy again. Must be more careful about how I phrase things.</div>`,
                choices: [
                    { text: "Change the subject and continue as before.", nextScene: "meeth_path_deep_in" } // Back to deeper involvement
                ]
            },
            meeth_re_explain_concern: {
                text: (gs) => `You try to gently clarify. "Niki, it's not that I mind helping, it's just... it's been a few requests, and I just wanted to make sure you're doing alright and not in any kind of trouble. Friends worry about each other, right?" <br>Her reply is more measured but still carries an edge. <blockquote>I appreciate you 'worrying', Meeth. But maybe just trust that I know what I'm doing? ğŸ¤” And maybe trust that if I ask for something, it's because I genuinely need it? I don't ask lightly, you know. ğŸ™„ Can we just drop this now? It's kinda awkward. ğŸ˜¬</blockquote> <div class="thought">She's still a bit annoyed. Maybe I am overthinking it. She says to trust her.</div>`,
                choices: [
                    { text: "Okay, drop the subject and trust her.", nextScene: "meeth_path_deep_in" }, // Path of trusting and ignoring concerns
                    { text: "Say you still have slight concerns but will drop it for now.", setFlag: { meeth_lingering_doubt: true }, nextScene: "meeth_chat_deepens" } // Lingering doubt, but still continuing
                ]
            },
            meeth_insist_video: {
                text: (gs) => `You decide to be more assertive about a video call. "Niki, I really like chatting with you, but it's been a while now. I'd really love to see your face, even just for a quick video call. Is your webcam *still* broken?" <br>Her response is immediate and defensive. <blockquote>Meeth, seriously?! ğŸ˜  Are you not happy with just chatting? Do you not trust me? I told you about my webcam issues! And now you're pushing it? This is making me really uncomfortable. ğŸ˜¡ Maybe I should just go... ğŸ’”</blockquote> <div class="thought">Oh no, I've upset her badly. She's threatening to leave. I didn't mean to push too hard.</div>`,
                choices: [
                    { text: "Back down immediately and apologize profusely.", nextScene: "meeth_back_down_video" },
                    { text: "Try to explain you just want to feel more connected.", nextScene: "meeth_explain_connection_video" }
                ]
            },
            meeth_back_down_video: {
                text: (gs) => `You rush to apologize. "Niki, no, no, I'm so sorry! I didn't mean to make you uncomfortable! ğŸ¥º Chatting is amazing, you're amazing! Please don't go! ğŸ˜­ I trust you, I do! I'm so sorry for pushing about the video. Forget I said anything! ğŸ™ğŸ’–" <blockquote>*Sigh*... Okay, Meeth. Apology accepted. Just... please don't push me like that again, okay? It's sensitive for me. ğŸ˜” Let's just... have a nice chat now? Forget this ever happened? ğŸ¥º</blockquote> <div class="thought">Crisis averted again. I need to be more careful. She's sensitive, and I value this connection too much to risk losing her.</div>`,
                choices: [
                    { text: "Agree and change the subject immediately.", setFlag: { meeth_avoids_video_again: true, niki_controls_video_topic: true }, nextScene: "meeth_chat_deepens" } // Further solidifies Niki's control
                ]
            },
            meeth_explain_connection_video: {
                text: (gs) => `You try to soften your request, "Niki, it's not about distrust at all! It's just... when you really connect with someone, seeing their face makes it feel more real, you know? It's about feeling closer to you, not about doubting you. I really like you, and seeing you would just make it even better for me." <br>Her reply is still resistant, but slightly less defensive. <blockquote>I get it, Meeth, I do. But it's just... not easy for me right now, okay? Maybe someday. Can we just... enjoy what we have now? The chatting is real, my feelings are real. Isn't that enough for now? ğŸ˜” Please? ğŸ™</blockquote> <div class="thought">She's not completely shutting it down, but still avoiding it. Maybe 'someday' is a possibility? But 'not easy for me right now'... what does that mean?</div>`,
                choices: [
                    { text: "Okay, accept 'someday' and drop it for now.", setFlag: { meeth_video_hope_someday: true, niki_deflects_video_again: true }, nextScene: "meeth_chat_deepens" }, // Lingering hope, but still no video
                    { text: "Gently push back a little. 'But what's making it not easy?'", nextScene: "meeth_push_gently_video_reason" } // Slightly riskier, might upset her again
                ]
            },
            meeth_push_gently_video_reason: {
                text: (gs) => `You cautiously ask, "I understand, Niki. But... is there a reason it's not easy right now? Is something wrong? Maybe I can help?" <br>Her response is vague and deflective. <blockquote>It's just personal stuff, Meeth, okay? Things I'm not really ready to talk about. Trust me? It's nothing to do with *you*. Just... me. ğŸ˜” Please respect my privacy? ğŸ™ Can we just... change the subject? ğŸ¥º</blockquote> <div class="thought">She's being very private. 'Personal stuff'... could be anything. Maybe it's unfair to push. But it's still frustrating.</div>`,
                choices: [
                    { text: "Respect her privacy and drop the video call issue again.", setFlag: { meeth_respects_privacy: true, niki_maintains_mystery: true }, nextScene: "meeth_chat_deepens" }, // Respect privacy, mystery deepens
                    { text: "Say you understand but you still really hope 'someday' comes soon.", nextScene: "meeth_hope_someday_soon" } // Expressing hope but still backing down
                ]
            },
            meeth_hope_someday_soon: {
                text: (gs) => `You reply, "Okay, Niki, I understand. Personal stuff is personal. I respect that. But... I really do hope 'someday' for a video call comes soon. I'm looking forward to it. ğŸ˜Š" <blockquote>Maybe... someday. ğŸ˜‰ For now, how about we just chat and dream? âœ¨ Tell me... if you could go anywhere in Estonia on your scooter right now, where would you go? ğŸ¤”ğŸ’–</blockquote> <div class="thought">She's smoothly changed the subject again. 'Someday'... feels less and less likely. But at least she's still chatting.</div>`,
                choices: [
                    { text: "Change the subject and continue chatting, putting video call hopes aside.", setFlag: { meeth_video_call_hopes_aside: true }, nextScene: "meeth_chat_deepens" } // Officially giving up on video for now
                ]
            },
            meeth_needs_moment: {
                text: (gs) => `You type slowly, "Niki... I need a moment. To think about things. Can we talk later?" <blockquote>Oh... ğŸ¥º Okay... if you need space, Meeth. ğŸ˜” I'll be here... if you want to talk. ğŸ’” Just... don't leave me hanging for too long, okay? ğŸ˜Ÿ Miss you already. ğŸ˜¥ğŸ’–</blockquote> <div class="thought">She sounds genuinely sad. But I do need to think. Berishbaev's words are echoing in my head.</div>`,
                choices: [
                    { text: "Take a break from chatting and think.", nextScene: "meeth_take_break_think" }, // Time to reflect
                    { text: "Ignore the doubts and continue chatting with Niki anyway.", nextScene: "meeth_ignore_doubts_continue" } // Denial path
                ]
            },
            meeth_take_break_think: {
                text: (gs) => `You log off from the chat with Niki and just stare at the screen. Berishbaev's points replay in your mind. The tech issues, the gift card, the never meeting in person, the lack of voice or video. Is it all just 'bad luck' and shyness? Or is there something more to it? The thought of Niki not being who she says she is... it's painful to even consider. But ignoring it feels wrong too. <div class="thought">Maybe I should talk to Berishbaev privately? Or HappyMan? Get another perspective?</div>`,
                choices: [
                    { text: "Message Berishbaev privately and ask to talk.", nextScene: "meeth_pm_beri_talk" },
                    { text: "Message HappyMan and ask for advice.", nextScene: "meeth_pm_happy_advice" },
                    { text: "Try to do some online research about catfishing signs.", nextScene: "meeth_online_research_catfish" },
                    { text: "Push the doubts away and log back in to chat with Niki.", nextScene: "meeth_ignore_doubts_continue" } // Back to denial
                ]
            },
            meeth_pm_beri_talk: {
                text: (gs) => `You message Berishbaev privately: "Hey Beri, can we talk for a minute? About... Niki. I need to ask you something, privately." Berishbaev replies quickly: "Sure, Meeth. I'm here. What's up?" <div class="thought">Okay, here goes. Time to face this directly.</div>`,
                choices: [
                    { text: "Ask Berishbaev to explain his suspicions in detail.", nextScene: "meeth_ask_beri_suspicions" },
                    { text: "Admit you have some doubts too and need his honest opinion.", nextScene: "meeth_admit_doubts_beri_opinion" }
                ]
            },
            meeth_ask_beri_suspicions: {
                text: (gs) => `You ask Berishbaev: "Okay, Beri, tell me everything. Why are you so suspicious of Niki? Lay it all out. I need to hear it straight." Berishbaev responds with a detailed list of his concerns, mirroring the 'red flags' he mentioned in the group chat, perhaps adding more specifics or examples. He speaks calmly and directly, focusing on the evidence and patterns he's observed. <div class="thought">Hearing it all laid out like this... it's hard to ignore. He's not being malicious, he sounds genuinely concerned.</div>`,
                choices: [
                    { text: "Thank Berishbaev for his honesty and say you need to think.", nextScene: "meeth_thank_beri_think" },
                    { text: "Defend Niki to Berishbaev, but listen to his points.", nextScene: "meeth_defend_niki_beri_points" },
                    { text: "Ask Berishbaev if he has any 'proof' beyond suspicion.", nextScene: "meeth_ask_beri_proof" }
                ]
            },
            meeth_thank_beri_think: {
                text: (gs) => `You reply to Berishbaev: "Thanks, Beri. For being honest, even if it's hard to hear. I need to think about all of this. Really think." Berishbaev responds: "Take your time, Meeth. I hope I'm wrong. But please, be careful." <div class="thought">He actually hopes he's wrong... that's telling. He's not enjoying this. I really do need to think seriously about everything he said.</div>`,
                choices: [
                    { text: "Reflect on Berishbaev's points and your interactions with Niki.", nextScene: "meeth_serious_reflection" },
                    { text: "Immediately message Niki and tell her what Berishbaev said.", nextScene: "meeth_tell_niki_beri_said" } // Risky confrontation
                ]
            },
            meeth_serious_reflection: {
                text: (gs) => `You spend time reflecting on your entire relationship with Niki. You go back through your chat logs, looking for inconsistencies, excuses, patterns. You compare Berishbaev's points to your own experiences. The more you think, the more unsettling it becomes. The 'bad luck' with tech, the vague stories, the gift card... it paints a worrying picture. <div class="thought">Could Berishbaev actually be right? Is Niki... not real? The thought is devastating. But the evidence... is starting to pile up.</div>`,
                choices: [
                    { text: "Decide to confront Niki directly with your doubts.", nextScene: "meeth_confront_niki_doubts_direct" },
                    { text: "Decide to try and find more proof before confronting Niki.", nextScene: "meeth_seek_more_proof" },
                    { text: "Still struggle to accept it and try to find counter-arguments.", nextScene: "meeth_find_counter_arguments" } // Denial, but wavering
                ]
            },
            meeth_confront_niki_doubts_direct: {
                text: (gs) => `You message Niki: "Niki, we need to talk seriously. Berishbaev has raised some serious concerns, and... I have to admit, some of them are making me wonder too. About... whether you're really who you say you are. I need you to be honest with me. Please." <div class="thought">This is it. No turning back now. Her response will tell me everything.</div>`,
                choices: [
                    { text: "Wait for Niki's response, bracing yourself for anything.", nextScene: "meeth_wait_niki_response_confrontation" }
                ]
            },
            meeth_wait_niki_response_confrontation: {
                text: (gs) => `...Silence. Minutes stretch into an eternity. You stare at the chat window, heart pounding, waiting for Niki's reply. Will she deny it? Get angry? Disappear? Or... could she possibly confess? The uncertainty is agonizing. Then, finally, a message notification pops up...`,
                choices: [
                    { text: "Read Niki's response...", nextScene: "niki_response_to_meeth_confrontation" } // Transition to Niki's response scene (needs to be created based on possible Niki reactions)
                ]
            },
             meeth_defend_niki_beri_points: {
                text: (gs) => `You reply to Berishbaev, "Beri, I hear what you're saying, but... Niki has explanations for everything. The tech issues are bad luck, the gift card was for her cousin, she's just shy about video. You're making it sound like she's deliberately lying, and I don't believe that." Berishbaev calmly counters each point, offering alternative interpretations and highlighting the pattern of excuses and lack of verifiable evidence. <div class="thought">He's persistent. He has answers for everything I say in defense of Niki. It's unsettling.</div>`,
                choices: [
                    { text: "Continue to defend Niki, but with wavering conviction.", setFlag: { meeth_wavering_defense: true }, nextScene: "meeth_wavering_defense_path" },
                    { text: "Start asking Berishbaev for specific examples or evidence.", nextScene: "meeth_ask_beri_specific_evidence" }
                ]
            },
            meeth_wavering_defense_path: {
                text: (gs) => `You keep trying to defend Niki, but Berishbaev's calm logic and persistent questioning are wearing you down. Your defenses feel weaker, your counter-arguments less convincing even to yourself. The doubts are creeping in despite your best efforts to deny them. <div class="thought">Maybe... maybe Berishbaev has a point. Maybe I'm just *wanting* to believe Niki so badly that I'm ignoring the red flags.</div>`,
                choices: [
                    { text: "Admit to Berishbaev that you're starting to have doubts.", nextScene: "meeth_admit_doubts_beri" },
                    { text: "Stubbornly continue to defend Niki, clinging to your belief.", nextScene: "meeth_stubborn_defense" } // Deeper denial path
                ]
            },
            meeth_admit_doubts_beri: {
                text: (gs) => `You type to Berishbaev, "Okay, Beri... I admit it. You've got me thinking. Some of the things you're saying... they do make sense. The constant excuses, the lack of video... maybe it's not just bad luck. Maybe... maybe I've been too trusting." Berishbaev responds gently, "It's okay to have doubts, Meeth. It's a natural reaction when something feels off. What do you want to do now?" <div class="thought">He's not gloating, he's being supportive. That makes it even harder to ignore. What *do* I do now?</div>`,
                choices: [
                    { text: "Ask Berishbaev for advice on how to proceed.", nextScene: "meeth_ask_beri_advice_next_step" },
                    { text: "Say you need to process this alone for a while.", nextScene: "meeth_process_alone_after_beri_doubt" }
                ]
            },
            meeth_ask_beri_advice_next_step: {
                text: (gs) => `You ask Berishbaev, "Beri, what do you think I should do now? You've been through something like this before, right? What's the best way to figure out the truth?" Berishbaev offers several suggestions, from reverse image searching Niki's photos, to asking for specific verifiable details about her life, to suggesting a direct but safe way to request a video call or voice message. He emphasizes caution and protecting yourself emotionally. <div class="thought">He's actually giving me helpful advice, not just criticism. Maybe working with him is the way to get to the bottom of this.</div>`,
                choices: [
                    { text: "Decide to follow Berishbaev's advice and investigate further.", nextScene: "meeth_follow_beri_advice_investigate" },
                    { text: "Thank Berishbaev for the advice but say you need to think about it more.", nextScene: "meeth_think_more_beri_advice" } // Still hesitant to act
                ]
            },
            meeth_follow_beri_advice_investigate: {
                text: (gs) => `You decide to take action based on Berishbaev's advice. You might start by reverse image searching Niki's profile pictures, or crafting a specific question to ask her that would be hard to fake if she's not genuine. You feel a mix of anxiety and determination. You need to know the truth, whatever it may be. <div class="thought">Time to do some digging. Let's see what I can find out.</div>`,
                choices: [
                    { text: "Begin your investigation...", nextScene: "meeth_investigation_starts" } // Scene where investigation actions and results are presented (needs further development)
                ]
            },
            meeth_investigation_starts: { // Placeholder - needs actual investigation mechanics and outcomes
                text: (gs) => `You start your investigation based on Berishbaev's advice. [This part of the story needs to be expanded to include specific actions the player can take (e.g., reverse image search, asking specific questions), and the potential results of those actions (finding proof, inconsistencies, etc.). For now, this is a placeholder.] You are now actively seeking the truth about Choco~Niki.`,
                choices: [
                    { text: "Continue the investigation...", nextScene: "meeth_investigation_continues" } // Placeholder for continuation
                ]
            },
             meeth_think_more_beri_advice: {
                text: (gs) => `You thank Berishbaev for his advice, but tell him you need more time to process everything before taking any action. You're still hesitant to fully confront the possibility that Niki might be deceiving you. The thought is too painful, and a part of you still hopes there's a simpler explanation. <div class="thought">I appreciate his help, but I'm not sure I'm ready to go digging for dirt on Niki. Maybe it'll all blow over. Maybe I'm just overreacting.</div>`,
                choices: [
                    { text: "Take more time to think and delay action.", nextScene: "meeth_delay_action_think_more" }, // Procrastination path
                    { text: "Reconsider Berishbaev's advice and decide to investigate after all.", nextScene: "meeth_follow_beri_advice_investigate" } // Path back to investigation
                ]
            },
            meeth_delay_action_think_more: {
                text: (gs) => `Days pass. You remain in a state of uncertainty, avoiding direct confrontation or investigation. You might continue chatting with Niki, trying to act normal while the doubts gnaw at you. The tension is building, and the unresolved questions are starting to affect your mood and interactions with everyone. <div class="thought">I'm in limbo. I can't keep ignoring this, but I'm scared of what I might find. Or what I might lose.</div>`,
                choices: [
                    { text: "This can't go on. Decide to take action now.", nextScene: "meeth_decide_take_action_limbo" }, // Decision point to break the limbo
                    { text: "Continue to delay, hoping the situation resolves itself (passive).", nextScene: "meeth_passive_delay_limbo" } // Path of continued inaction (likely bad outcome)
                ]
            },
            meeth_decide_take_action_limbo: {
                text: (gs) => `You realize you can't stay in this state of uncertainty any longer. The anxiety is too much. You decide you need to take some kind of action to resolve the situation, whether it's confronting Niki, investigating further, or talking to your friends again. <div class="thought">Enough is enough. I need answers. Time to do something.</div>`,
                choices: [
                    { text: "Confront Niki directly.", nextScene: "meeth_confront_niki_doubts_direct" }, // Direct confrontation path
                    { text: "Start investigating based on Berishbaev's advice.", nextScene: "meeth_follow_beri_advice_investigate" }, // Investigation path
                    { text: "Talk to HappyMan again for advice and support.", nextScene: "meeth_talk_happy_again_advice" } // Seek HappyMan's mediation again
                ]
            },
             meeth_passive_delay_limbo: {
                text: (gs) => `You continue to avoid confronting the issue, hoping it will somehow resolve itself or that Berishbaev is wrong. You might try to convince yourself that you're overthinking it, or that Niki's explanations are good enough. But the doubts persist, and the unresolved tension casts a shadow over everything. <div class="thought">Maybe if I just ignore it, it will go away. Maybe it's all in my head. But it's getting harder and harder to ignore.</div>`,
                choices: [
                    { text: "Inevitably, the situation comes to a head...", nextScene: "shared_confrontation_start" } // Inaction leads to external confrontation
                ]
            },
            meeth_talk_happy_again_advice: {
                text: (gs) => `You reach out to HappyMan again, explaining your conversation with Berishbaev and your growing doubts. You ask for his perspective and advice on how to handle the situation. HappyMan listens patiently and offers his balanced viewpoint, acknowledging Berishbaev's concerns while also urging caution against jumping to conclusions. He emphasizes the importance of clear communication and finding a way to address the doubts constructively. <div class="thought">HappyMan is always so calm and reasonable. Maybe he can help me find a way through this without things exploding.</div>`,
                choices: [
                    { text: "Ask HappyMan to mediate a group conversation about it.", nextScene: "meeth_ask_happy_mediate_group_chat" },
                    { text: "Follow HappyMan's advice and try to communicate your doubts to Niki calmly.", nextScene: "meeth_communicate_doubts_calmly_niki" },
                    { text: "Thank HappyMan for his advice but decide to investigate on your own first.", nextScene: "meeth_follow_beri_advice_investigate" } // Path to investigation after HappyMan's advice
                ]
            },
            meeth_ask_happy_mediate_group_chat: {
                text: (gs) => `You ask HappyMan if he would be willing to mediate a group chat where you, Berishbaev, and possibly AdamMady could discuss the situation with Choco~Niki. You hope HappyMan's calm presence can prevent things from escalating and facilitate a more constructive conversation. HappyMan agrees to try. <div class="thought">Maybe with HappyMan mediating, we can actually have a rational discussion instead of just arguing. It's worth a shot.</div>`,
                choices: [
                    { text: "Initiate the mediated group chat.", nextScene: "shared_mediated_group_chat_start" } // Scene for mediated group chat (needs to be created)
                ]
            },
             meeth_communicate_doubts_calmly_niki: {
                text: (gs) => `Following HappyMan's advice, you decide to try and communicate your doubts to Niki in a calm and non-accusatory way. You carefully craft a message expressing your feelings and concerns, emphasizing that you value the connection but need clarity on some issues to feel fully secure in the relationship. You avoid direct accusations and focus on your own need for reassurance. <div class="thought">This is nerve-wracking. I hope she understands and doesn't get too upset. I just want to be honest about how I'm feeling.</div>`,
                choices: [
                    { text: "Send the message to Niki and wait for her response.", nextScene: "meeth_wait_niki_response_calm_doubts" } // Scene for Niki's response to calm communication of doubts
                ]
            },
            meeth_wait_niki_response_calm_doubts: {
                text: (gs) => `You send your carefully worded message to Niki, expressing your doubts and need for reassurance in a calm way. Now, you wait anxiously for her reply. Will she be receptive to your approach? Will she finally address the issues openly? Or will she become defensive or dismissive? The outcome is uncertain, but you've taken a step towards honest communication.`,
                choices: [
                    { text: "See Niki's response...", nextScene: "niki_response_to_calm_doubts_meeth" } // Scene for Niki's response (needs to be created based on possible reactions)
                ]
            },
            meeth_stubborn_defense: {
                text: (gs) => `Despite Berishbaev's increasingly compelling arguments, you stubbornly cling to your belief in Niki. You might argue back more forcefully, dismiss Berishbaev's concerns as paranoia or jealousy, or simply refuse to engage with his points at all. You're determined to maintain your idealized image of Niki, even if it means ignoring red flags and rational arguments. <div class="thought">Berishbaev is wrong. He just doesn't understand Niki like I do. I'm not going to let him ruin this for me.</div>`,
                choices: [
                    { text: "Continue to stubbornly defend Niki and dismiss doubts.", nextScene: "meeth_deeper_denial_path" } // Path of deeper denial
                ]
            },
            meeth_deeper_denial_path: {
                text: (gs) => `You double down on your denial, actively pushing away any doubts and reinforcing your belief in Niki's genuineness. You might seek out validation from AdamMady, avoid further conversations with Berishbaev, and focus even more intently on your interactions with Niki. You're constructing a wall of denial to protect yourself from a potentially painful truth. <div class="thought">I just need to believe in Niki. If I believe hard enough, everything will be okay. Berishbaev will see he's wrong.</div>`,
                choices: [
                    { text: "Continue down the path of denial...", nextScene: "shared_confrontation_start" } // Denial ultimately leads to external confrontation
                ]
            },
            meeth_admit_doubts_beri_opinion: {
                text: (gs) => `You confess to Berishbaev, "Beri, okay, you've got me worried. I'm starting to doubt things too. What do *you* honestly think is going on? Is she really catfishing me? Is she really... a man, like you asked?" You lay your vulnerability bare, seeking Berishbaev's most direct and honest assessment. <div class="thought">I need to know what he really thinks, even if it hurts. I can't keep living in this uncertainty.</div>`,
                choices: [
                    { text: "Wait for Berishbaev's honest opinion and assessment.", nextScene: "meeth_wait_beri_honest_opinion" } // Scene for Berishbaev's honest opinion
                ]
            },
            meeth_wait_beri_honest_opinion: {
                text: (gs) => `You've asked Berishbaev for his honest opinion, admitting your own doubts and directly addressing his question about Niki's gender. Now, you wait for his response, bracing yourself for whatever he might say. His assessment could be the push you need to fully confront the situation, or it might offer a sliver of reassurance (though unlikely given his skepticism). The weight of anticipation is heavy.`,
                choices: [
                    { text: "Hear Berishbaev's honest opinion...", nextScene: "beri_honest_opinion_meeth_response" } // Scene for Berishbaev's opinion and Meethexep's reaction (needs to be created)
                ]
            },
            meeth_ask_beri_proof: {
                text: (gs) => `You challenge Berishbaev, "Okay, Beri, you've made your case. But do you have any *proof*? Or is this all just suspicion and circumstantial evidence? If you're going to accuse Niki of lying, show me something concrete." You demand definitive evidence, pushing back against his general concerns and wanting something undeniable to confirm his suspicions. <div class="thought">If he has proof, I need to see it. If not, maybe it's just his paranoia getting the better of him.</div>`,
                choices: [
                    { text: "Wait for Berishbaev to respond with evidence or lack thereof.", nextScene: "meeth_wait_beri_proof_response" } // Scene for Berishbaev's proof response
                ]
            },
            meeth_wait_beri_proof_response: {
                text: (gs) => `You've demanded proof from Berishbaev, challenging him to provide concrete evidence to back up his suspicions about Choco~Niki. Now, you wait to see if he can deliver. Does he have screenshots, reverse image search results, or other solid evidence? Or will he admit it's based on patterns and gut feeling? His response will heavily influence your next steps.`,
                choices: [
                    { text: "See Berishbaev's response regarding proof...", nextScene: "beri_proof_response_meeth_reaction" } // Scene for Berishbaev's proof and Meethexep's reaction (needs to be created)
                ]
            },
            meeth_online_research_catfish: {
                text: (gs) => `You decide to do your own research online about the signs of catfishing. You search for articles, forums, and videos discussing red flags and common tactics used by catfishers. As you read, you start to see alarming parallels between the information you find and your relationship with Choco~Niki. The 'tech issues', the vague personal details, the idealization, the requests for small favors... it all resonates uncomfortably. <div class="thought">This is...disturbing. So many of these signs match my situation with Niki. Is it really possible?</div>`,
                choices: [
                    { text: "Continue your research, digging deeper into catfishing tactics.", nextScene: "meeth_deeper_online_research" },
                    { text: "Stop researching, feeling overwhelmed and scared by what you're finding.", nextScene: "meeth_stop_research_overwhelmed" },
                    { text: "Decide to use what you've learned to test Niki or look for specific inconsistencies.", nextScene: "meeth_use_research_test_niki" } // Action based on research
                ]
            },
            meeth_deeper_online_research: {
                text: (gs) => `You delve deeper into online resources about catfishing. You learn about different types of catfishers, their motivations, and the psychological manipulation tactics they often employ. You find stories from victims, sharing experiences that eerily mirror your own growing unease. The more you learn, the more convinced you become that Berishbaev might be right, and that you could be a target of deception. <div class="thought">This is getting scary. The more I read, the more it sounds like Niki. I need to face this.</div>`,
                choices: [
                    { text: "Decide to confront Niki directly with your research findings.", nextScene: "meeth_confront_niki_research_findings" },
                    { text: "Use your research to look for specific inconsistencies in Niki's stories or profile.", nextScene: "meeth_use_research_find_inconsistencies" },
                    { text: "Talk to HappyMan about what you've learned and ask for his advice.", nextScene: "meeth_talk_happy_research_advice" } // Seek HappyMan's guidance after research
                ]
            },
            meeth_confront_niki_research_findings: {
                text: (gs) => `Armed with your online research, you decide to confront Niki directly. You message her, explaining that you've been reading about catfishing and that many of the red flags described match your situation. You ask her to address these concerns honestly and openly, and to reassure you that she is who she claims to be. <div class="thought">This is a direct challenge. Let's see how she responds when I bring up catfishing explicitly.</div>`,
                choices: [
                    { text: "Wait for Niki's response to your confrontation about catfishing.", nextScene: "meeth_wait_niki_response_catfish_confrontation" } // Scene for Niki's response to direct catfish accusation
                ]
            },
            meeth_wait_niki_response_catfish_confrontation: {
                text: (gs) => `You've laid it all out for Niki, directly confronting her with the possibility of catfishing based on your online research. The ball is in her court now. How will she react to this explicit accusation? Will she deny it, get angry, try to manipulate you, or perhaps even confess? Her response will determine the course of the story from here.`,
                choices: [
                    { text: "See Niki's response to the catfishing accusation...", nextScene: "niki_response_to_catfish_accusation_meeth" } // Scene for Niki's response (needs to be created based on reactions)
                ]
            },
            meeth_use_research_find_inconsistencies: {
                text: (gs) => `Using what you've learned from your online research, you start to scrutinize Niki's profile and past messages for inconsistencies. You look for contradictory details, vague answers, and anything that doesn't quite add up. You might compare her profile pictures to online image databases, or cross-reference details she's shared about her life. You're actively searching for cracks in the facade. <div class="thought">Time to play detective. Let's see if I can find any real holes in her story.</div>`,
                choices: [
                    { text: "Continue searching for inconsistencies...", nextScene: "meeth_continue_search_inconsistencies" } // Scene where player actions and potential findings are detailed (needs to be developed)
                ]
            },
            meeth_continue_search_inconsistencies: { // Placeholder - needs to be developed with actual investigation steps
                text: (gs) => `You continue your search for inconsistencies in Niki's profile and messages. [This part of the story needs to be expanded to include specific actions the player can take (e.g., reviewing chat logs, profile details, etc.) and the potential outcomes (finding inconsistencies, dead ends, etc.). For now, it's a placeholder.] You are now actively trying to uncover evidence of deception.`,
                choices: [
                    { text: "Continue your investigation...", nextScene: "meeth_investigation_continues" } // Placeholder for continuation
                ]
            },
            meeth_stop_research_overwhelmed: {
                text: (gs) => `The more you research catfishing, the more overwhelmed and scared you become. The similarities between the red flags and your relationship with Niki are too unsettling. You decide to stop researching, feeling emotionally drained and afraid of what you might uncover if you dig deeper. Ignorance feels safer, even if it's just an illusion. <div class="thought">I can't do this anymore. It's too scary. Maybe it's better not to know.</div>`,
                choices: [
                    { text: "Try to put the research out of your mind and continue as if nothing has changed.", nextScene: "meeth_continue_denial_after_research" }, // Denial path after research
                    { text: "Despite your fear, decide you need to know the truth and resume researching.", nextScene: "meeth_resume_research_truth" } // Path back to research
                ]
            },
            meeth_continue_denial_after_research: {
                text: (gs) => `You try to push the unsettling research findings out of your mind and go back to your routine, including chatting with Niki. You attempt to act as if nothing has changed, hoping to maintain the illusion of the relationship and avoid confronting the painful possibility of deception. But the knowledge you've gained lingers in the back of your mind, making it harder to fully immerse yourself in the fantasy. <div class="thought">Maybe if I just pretend I didn't read all that, it'll go away. Maybe things can go back to normal. But can they, really?</div>`,
                choices: [
                    { text: "Continue down the path of denial, but the cracks are showing...", nextScene: "shared_confrontation_start" } // Denial becomes unsustainable
                ]
            },
            meeth_resume_research_truth: {
                text: (gs) => `Despite your fear and initial overwhelm, you realize you can't ignore what you've learned. The need for truth outweighs your desire for comfort. You decide to resume your online research, determined to gather more information and understand the situation fully, even if it's painful. <div class="thought">I was scared, but I can't run from this. I need to know the truth, no matter what it is. Back to the research.</div>`,
                choices: [
                    { text: "Continue your research with renewed determination.", nextScene: "meeth_deeper_online_research" } // Back to deeper research path
                ]
            },
            meeth_talk_happy_research_advice: {
                text: (gs) => `You reach out to HappyMan, explaining that you've been doing online research about catfishing and are now even more concerned about Choco~Niki. You share some of the red flags you've learned about and ask for HappyMan's advice on how to proceed. You value his calm and balanced perspective and hope he can offer guidance on navigating this difficult situation. <div class="thought">HappyMan is always level-headed. Maybe he can help me make sense of all this research and figure out what to do next.</div>`,
                choices: [
                    { text: "Ask HappyMan for specific advice on how to address your research findings with Niki or your friends.", nextScene: "meeth_ask_happy_advice_research_findings" }
                ]
            },
            meeth_ask_happy_advice_research_findings: {
                text: (gs) => `You ask HappyMan for specific advice on how to use your research findings to address the situation with Choco~Niki or your friends. You want to approach this constructively and minimize conflict, but you also need to get to the truth. HappyMan considers your request and offers suggestions, perhaps advising you to share your research calmly with Niki, or to discuss it with Berishbaev and AdamMady in a mediated group chat. He emphasizes clear communication and avoiding accusations. <div class="thought">HappyMan's advice is always practical. Let's see what he suggests and how I can use it.</div>`,
                choices: [
                    { text: "Follow HappyMan's advice and take the next step.", nextScene: "meeth_follow_happy_advice_research_action" } // Scene where player takes action based on HappyMan's advice (needs to be developed)
                ]
            },
            meeth_follow_happy_advice_research_action: { // Placeholder - needs to be developed with action based on HappyMan's advice
                text: (gs) => `Following HappyMan's advice, you decide on a course of action based on your online research and his suggestions. [This part of the story needs to be expanded to include specific actions the player can take based on HappyMan's advice, and the potential outcomes of those actions. For now, it's a placeholder.] You are now taking a deliberate step to address the catfishing concerns, guided by HappyMan's wisdom.`,
                choices: [
                    { text: "Proceed with your chosen action...", nextScene: "meeth_action_based_on_happy_advice_continues" } // Placeholder for continuation
                ]
            },
            meeth_action_based_on_happy_advice_continues: { // Placeholder for continuation of action based on HappyMan's advice
                text: (gs) => `You proceed with the action you've chosen, guided by HappyMan's advice and your online research. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences. The story branches here depending on the chosen path.] The next phase of your journey to uncover the truth about Choco~Niki begins.`,
                choices: [
                    { text: "Continue the story...", nextScene: "..." } // Placeholder for further story progression
                ]
            },


            // === CHOCO~NIKI SCENES ENDINGS ===
            niki_wait_movie_response: {
                text: (gs) => `Meethexep agrees enthusiastically to the movie night. Perfect. He's easily distracted and eager to please. <div class="thought">Movie night it is. Another night, no voice, no video, just text and emojis. Easy peasy.</div>`,
                choices: [
                    { text: "Prepare for 'movie night'.", nextScene: "niki_continue_charade" }
                ]
            },
            niki_double_text: {
                text: (gs) => `You send another message quickly, acting eager and a little needy. "Hey again! ğŸ‘‹ Just wondering what you're up to! ğŸ˜Š Miss you already! ğŸ˜˜" <div class="thought">A little extra attention early on never hurts. Makes him feel wanted, keeps him hooked.</div>`,
                choices: [
                    { text: "Wait for his (now even more eager) reply.", nextScene: "niki_wait_reply" }
                ]
            },
            niki_wait_call_response: {
                text: (gs) => {
                    let next_scene = "niki_continue_charade";
                    let thought_text = "Dodged that bullet. Voice call averted. Back to safe texting territory.";
                    let choices = [{ text: "Continue the charade.", nextScene: "niki_continue_charade" }];

                    if (gs.flags.adam_mentioned) {
                        thought_text = "He actually mentioned Adam thought I sounded great? Uh oh. Need to be careful. Maybe Adam is a potential problem.";
                        choices = [
                            { text: "Continue the charade, but monitor AdamMady.", nextScene: "niki_continue_charade" },
                            { text: "Subtly try to create distance between Meethexep and Adam.", nextScene: "niki_poison_adam" } // New option to manipulate relationships
                        ];
                    }

                    return {
                        text: (gs) => `${text}(gs) <div class="thought">${thought_text}</div>`,
                        choices: choices
                    }
                }
            },
            niki_poison_adam: {
                text: (gs) => `Time to subtly sow seeds of doubt about AdamMady in Meethexep's mind. Need to be careful, indirect. Maybe imply Adam is slightly jealous, or doesn't 'get' your connection with Meethexep. <div class="thought">Divide and conquer. If Adam is a potential threat, need to isolate Meethexep from him.</div> You might send messages to Meethexep like: <blockquote>"Adam is sweet, but sometimes he doesn't really *get* our vibe, does he? ğŸ˜‰ Just feels like he's a bit... distant from our special connection, you know? ğŸ˜” No biggie, just a thought! ğŸ˜˜ğŸ’–"</blockquote>`,
                choices: [
                    { text: "See if Meethexep takes the bait.", nextScene: "niki_wait_meeth_adam_poison_response" }
                ]
            },
            niki_wait_meeth_adam_poison_response: {
                text: (gs) => `You've sent the subtle 'poison' message about AdamMady to Meethexep. Now, you wait to see how he reacts. Will he agree with your assessment of Adam? Will he start to distance himself from his friend? Or will he dismiss your concerns? His response will indicate how successful this manipulation tactic is.`,
                choices: [
                    { text: "Gauge Meethexep's reaction to your AdamMady comment.", nextScene: "meeth_reaction_to_niki_adam_poison" } // Scene for Meethexep's reaction (needs to be created)
                ]
            },
            niki_status_quo: {
                text: (gs) => `Things are stable. Meethexep is engaged, the friends are mostly manageable. Small favors continue, keeping him invested. The charade is holding. For now. <div class="thought">Keep it going. Don't get complacent. Always be ready for Berishbaev to stir things up again. And maybe keep an eye on AdamMady too, just in case.</div>`,
                choices: [
                    { text: "Maintain the status quo, for now.", nextScene: "niki_long_term_plan" } // Continue long-term strategy
                ]
            },
            niki_poison_beri: {
                text: (gs) => `Time to subtly poison Meethexep against Berishbaev. Make Berishbaev sound negative, untrusting, maybe even a bit mean-spirited. Play on Meethexep's desire for happiness and positive vibes. <div class="thought">Berishbaev is the main threat. Need to undermine his credibility in Meethexep's eyes. Make him seem like the 'bad guy'.</div> You might send messages like: <blockquote>"Ugh, Berishbaev is being negative again in the group chat? ğŸ™„ He just doesn't seem happy for you, does he? ğŸ˜” Some people are just like that, always finding fault. ğŸ˜Ÿ Don't let him bring you down, okay? You deserve to be happy! âœ¨ğŸ’–"</blockquote>`,
                choices: [
                    { text: "See if Meethexep takes the bait and becomes more distrustful of Berishbaev.", nextScene: "niki_wait_meeth_beri_poison_response" }
                ]
            },
            niki_wait_meeth_beri_poison_response: {
                text: (gs) => `You've sent the 'poison' message about Berishbaev to Meethexep, subtly portraying him as negative and untrusting. Now, you wait to see how Meethexep reacts. Will he become more dismissive of Berishbaev's concerns? Will he start to distance himself from Berishbaev? Or will he see through your manipulation? His response will indicate the effectiveness of this tactic.`,
                choices: [
                    { text: "Gauge Meethexep's reaction to your Berishbaev comment.", nextScene: "meeth_reaction_to_niki_beri_poison" } // Scene for Meethexep's reaction (needs to be created)
                ]
            },
            niki_confront_play_victim: {
                text: (gs) => `You message Meethexep immediately, expressing hurt and confusion. <blockquote>"Meeth... ğŸ¥º I'm so confused and upset! Berishbaev is saying all these things about me? ğŸ˜¥ After I've been so open and honest with you? ğŸ’” It really hurts that your friends doubt me... and that you're even telling me about it! ğŸ˜­ Do *you* doubt me too, Meeth? ğŸ¥º Please say no... ğŸ˜¥ğŸ’–"</blockquote> <div class="thought">Play on his guilt, his sympathy. Make him defend you against his friends. Reinforce his trust in *you* specifically.</div>`,
                choices: [
                    { text: "Wait for Meethexep's reaction, hoping he falls for the victim act.", nextScene: "niki_wait_meeth_victim_response" }
                ]
            },
            niki_wait_meeth_victim_response: {
                text: (gs) => `You've played the victim card, expressing hurt and confusion at Berishbaev's accusations and Meethexep's sharing of them. Now, you wait for Meethexep's reaction. Will he rush to reassure you and defend you against his friends? Will he express his unwavering trust in you? Or will he show signs of doubt despite your manipulation attempt? His response will determine your next move.`,
                choices: [
                    { text: "See how Meethexep reacts to your victim act.", nextScene: "meeth_reaction_to_niki_victim_play" } // Scene for Meethexep's reaction (needs to be created)
                ]
            },
            niki_confront_blame_beri: {
                text: (gs) => `You message Meethexep, shifting the blame to Berishbaev directly. <blockquote>"Meeth, Berishbaev is being so unfair! ğŸ˜  He's just trying to cause trouble and ruin things for us! ğŸ˜¡ Why is he doing this? Is he jealous? ğŸ¤¨ Or does he just enjoy being negative? ğŸ™„ Please don't listen to him, okay? He's wrong about me! ğŸ˜¥ Trust *your* feelings, Meeth, not his negativity! ğŸ™ğŸ’–"</blockquote> <div class="thought">Attack Berishbaev directly. Make him the villain. Plant seeds of doubt about his motives. Reinforce the idea that Meethexep's feelings are the 'real' truth.</div>`,
                choices: [
                    { text: "Wait for Meethexep's reaction, hoping he turns against Berishbaev.", nextScene: "niki_wait_meeth_blame_beri_response" }
                ]
            },
            niki_wait_meeth_blame_beri_response: {
                text: (gs) => `You've directly blamed Berishbaev for the conflict, portraying him as the troublemaker and urging Meethexep to distrust his motives. Now, you wait for Meethexep's reaction. Will he side with you against Berishbaev? Will he dismiss Berishbaev's concerns as just negativity or jealousy? Or will he still try to consider Berishbaev's points despite your attempt to discredit him? His response will reveal how effective this blame tactic is.`,
                choices: [
                    { text: "See how Meethexep reacts to your blaming of Berishbaev.", nextScene: "meeth_reaction_to_niki_blame_beri" } // Scene for Meethexep's reaction (needs to be created)
                ]
            },
            niki_confront_wait: {
                text: (gs) => `You decide to wait and see how Meethexep handles the confrontation in the group chat first, before directly intervening. You monitor Meethexep's messages to you and any hints he might drop about the group conversation. You want to gauge the situation and time your response for maximum impact. <div class="thought">Let them fight it out for a bit. See where Meethexep's head is at. Then I can jump in with the right approach. Patience is key.</div>`,
                choices: [
                    { text: "Observe the fallout and prepare your next move.", nextScene: "niki_observe_fallout_prep_move" } // Scene for observation and planning
                ]
            },
            niki_observe_fallout_prep_move: {
                text: (gs) => `You're observing the fallout of the group chat confrontation, waiting for the right moment to intervene. You might be looking for signs of Meethexep's wavering trust in you, or for opportunities to exploit divisions between him and his friends. You're planning your next move strategically, aiming to regain control of the situation and solidify your hold on Meethexep. <div class="thought">Time to strategize. How can I turn this confrontation to my advantage? How can I make Meethexep trust me *more* than his friends?</div>`,
                choices: [
                    { text: "Decide on your next move based on the observed fallout.", nextScene: "niki_decide_next_move_fallout" } // Scene where player chooses next tactic (needs to be developed based on strategy)
                ]
            },
            niki_decide_next_move_fallout: { // Placeholder - needs to be developed with strategic choices
                text: (gs) => `Based on your observation of the fallout from the group chat confrontation, you're now deciding on your next move. [This part of the story needs to be expanded to include specific strategic choices the player can make (e.g., playing victim, blaming Berishbaev, expressing vulnerability), and the potential consequences of those choices. For now, it's a placeholder.] You are now actively strategizing to maintain the charade and control the narrative.`,
                choices: [
                    { text: "Execute your chosen strategy...", nextScene: "niki_execute_strategy_fallout" } // Placeholder for strategy execution
                ]
            },
            niki_execute_strategy_fallout: { // Placeholder - needs to be developed with strategy execution and consequences
                text: (gs) => `You execute your chosen strategy to manage the fallout from the group chat confrontation and regain control of the situation. [This scene and subsequent scenes need to be developed to reflect the specific strategies chosen by the player and the evolving consequences. The story branches here depending on the chosen path.] The success or failure of your strategy will determine the next phase of the charade and your relationship with Meethexep.`,
                choices: [
                    { text: "Continue the story...", nextScene: "..." } // Placeholder for further story progression
                ]
            },
            niki_response_to_meeth_confrontation: { // Placeholder - needs to be developed with different Niki responses
                text: (gs) => `Niki has responded to your direct confrontation about being honest about who she is. [This scene needs to be developed to include different possible responses from Niki: denial, anger, manipulation, confession, etc. Each response leads to a different branch of the story.] Her reaction will determine the immediate outcome of your confrontation.`,
                choices: [
                    { text: "React to Niki's response...", nextScene: "..." } // Placeholder for player reaction and further story
                ]
            },
            niki_response_to_calm_doubts_meeth: { // Placeholder - needs to be developed with different Niki responses
                text: (gs) => `Niki has responded to your calm and non-accusatory message expressing your doubts and need for reassurance. [This scene needs to be developed to include different possible responses from Niki: reassurance, deflection, manipulation, anger, etc. Each response leads to a different branch of the story.] Her reaction will determine whether your attempt at calm communication is successful or backfires.`,
                choices: [
                    { text: "Analyze Niki's response and decide your next move...", nextScene: "..." } // Placeholder for player decision and further story
                ]
            },
            niki_response_to_catfish_accusation_meeth: { // Placeholder - needs to be developed with different Niki responses
                text: (gs) => `Niki has responded to your direct accusation of catfishing based on your online research. [This scene needs to be developed to include different possible responses from Niki: vehement denial, counter-accusation, manipulation, confession (unlikely but possible), disappearance, etc. Each response leads to a different branch of the story.] Her reaction will determine the immediate aftermath of your direct confrontation.`,
                choices: [
                    { text: "Assess Niki's reaction to the catfishing accusation and plan your next step...", nextScene: "..." } // Placeholder for player assessment and further story
                ]
            },
            beri_honest_opinion_meeth_response: { // Placeholder - needs to be developed with Beri's opinion and Meeth's reaction
                text: (gs) => `Berishbaev has given you his honest opinion, in response to you admitting your doubts and asking about Niki's gender. [This scene needs to be developed to include Berishbaev's opinion (likely confirming his suspicions, but with different levels of certainty and advice) and Meethexep's reaction to it (acceptance, denial, further questions, etc.). Each reaction leads to a different story branch.] Berishbaev's assessment and your response will shape your next actions.`,
                choices: [
                    { text: "Consider Berishbaev's opinion and decide how to proceed...", nextScene: "..." } // Placeholder for player decision and further story
                ]
            },
            beri_proof_response_meeth_reaction: { // Placeholder - needs to be developed with Beri's proof (or lack thereof) and Meeth's reaction
                text: (gs) => `Berishbaev has responded to your demand for proof, either providing evidence or admitting he doesn't have concrete proof. [This scene needs to be developed to include Berishbaev's response regarding proof (screenshots, image search results, admission of no proof) and Meethexep's reaction to it (belief, disbelief, further questions, demanding more proof, etc.). Each reaction leads to a different story branch.] The presence or absence of proof, and your reaction, will determine your next steps.`,
                choices: [
                    { text: "Evaluate Berishbaev's proof (or lack thereof) and plan your next move...", nextScene: "..." } // Placeholder for player evaluation and further story
                ]
            },


            // === ADAMMADY SCENES ENDINGS ===
            adam_movie_night: { // Assuming this was a typo and should be meeth_movie_night, redirecting to meeth_movie_night
                 text: (gs) => story.meeth_movie_night.text(gs),
                 choices: story.meeth_movie_night.choices
             },
            adam_later: {
                 text: (gs) => `Time continues. You remain supportive of Meethexep and Niki. You occasionally hear Berishbaev's grumbling skepticism, but you dismiss it as negativity. HappyMan tries to keep things balanced, but you see him as enabling Berishbaev's negativity. You're firmly in 'Team Niki'.`,
                 choices: [
                     { text: "Continue supporting Meethexep and Niki.", nextScene: "adam_status_quo" }
                 ]
             },
             adam_status_quo: {
                 text: (gs) => `Things are stable, at least from your perspective. Meethexep seems happy, Niki seems great, Berishbaev is just being Berishbaev. You see no reason to doubt anything and continue to be a positive influence in Meethexep's life and relationship.`,
                 choices: [
                     { text: "Maintain the status quo.", nextScene: "adam_further_support" }
                 ]
             },
             adam_further_support: {
                 text: (gs) => `You continue to offer unwavering support to Meethexep and Niki, reinforcing their relationship and dismissing any doubts or concerns raised by others. You are the steadfast champion of their love, believing wholeheartedly in their connection.`,
                 choices: [
                     { text: "Time passes, leading towards potential confrontation...", nextScene: "shared_confrontation_start" } // Inevitable confrontation
                 ]
             },
             adam_gentle_check: {
                 text: (gs) => `A tiny seed of doubt starts to sprout. Just a flicker. You wonder if maybe Berishbaev *could* have a point about the lack of voice or video calls. You decide to gently check in with Meethexep. "Hey Meeth, just checking in. You're really happy with Niki, right? Everything is... good good?"`,
                 choices: [
                     { text: "Wait for Meethexep's response to your gentle check-in.", nextScene: "adam_wait_meeth_gentle_check_response" }
                 ]
             },
             adam_wait_meeth_gentle_check_response: {
                 text: (gs) => `You've sent a gentle check-in message to Meethexep, subtly probing about his happiness and the 'goodness' of his relationship with Niki. Now, you wait for his response. Will he reassure you wholeheartedly? Will he express any hesitation or uncertainty? Or will he brush off your question? His answer might reveal more than he intends.`,
                 choices: [
                     { text: "See Meethexep's response to your gentle check-in.", nextScene: "meeth_reaction_to_adam_gentle_check" } // Scene for Meethexep's reaction (needs to be created)
                 ]
             },
             adam_confront_attack_beri: {
                 text: (gs) => `You lash out at Berishbaev. "Berishbaev, you're just jealous or something! Why are you always so negative? You're trying to ruin Meethexep's happiness! Just stop it! You're being a terrible friend!" You attack his motives and character, dismissing his concerns without addressing the substance of his points.`,
                 choices: [
                     { text: "Continue attacking Berishbaev and defend Niki.", nextScene: "adam_further_attack_beri" }
                 ]
             },
             adam_further_attack_beri: {
                 text: (gs) => `You escalate your attacks on Berishbaev, becoming more personal and aggressive. You might accuse him of being bitter, lonely, or intentionally malicious. You are determined to shut down his skepticism and protect Meethexep and Niki from his 'negativity'.`,
                 choices: [
                     { text: "Continue down this path of attacking Berishbaev...", nextScene: "shared_confrontation_beri_question" } // Inevitably leads to Beri's big question
                 ]
             },
             adam_confront_reassure_meeth: {
                 text: (gs) => `You focus on reassuring Meethexep. "Meeth, don't listen to Berishbaev! He's totally wrong about Niki! She's amazing, you guys are great together! He's just being negative as usual. Ignore him and focus on your happiness with Niki! We're all happy for you, except for grumpy Beri! ğŸ˜Š" You try to bolster Meethexep's confidence and dismiss Berishbaev's concerns as irrelevant.`,
                 choices: [
                     { text: "Continue reassuring Meethexep and dismissing Berishbaev.", nextScene: "adam_further_reassure_meeth" }
                 ]
             },
             adam_further_reassure_meeth: {
                 text: (gs) => `You keep showering Meethexep with reassurance and positive affirmations about his relationship with Niki. You might send him private messages of support, or publicly defend Niki in the group chat, always emphasizing the positive and downplaying any potential issues. You are his unwavering cheerleader.`,
                 choices: [
                     { text: "Continue down this path of reassurance...", nextScene: "shared_confrontation_beri_question" } // Leads to Beri's question despite your reassurance
                 ]
             },
             adam_confront_refute_beri: {
                 text: (gs) => `You attempt to directly refute Berishbaev's 'evidence' point by point. "Beri, you say no voice calls? Maybe she's shy! You say gift card? Maybe she really needed help! You're twisting everything to fit your negative narrative! You're being unfair to Niki and to Meeth!" You try to debunk his claims and defend Niki's explanations.`,
                 choices: [
                     { text: "Continue trying to refute Berishbaev's 'evidence'.", nextScene: "adam_further_refute_beri" }
                 ]
             },
             adam_further_refute_beri: {
                 text: (gs) => `You persist in trying to find alternative explanations for all of Berishbaev's concerns, actively refuting each point he raises. You are determined to dismantle his 'case' against Niki, even if it requires some mental gymnastics and ignoring inconsistencies.`,
                 choices: [
                     { text: "Continue down this path of refuting Berishbaev...", nextScene: "shared_confrontation_beri_question" } // Leads to Beri's question despite your refutations
                 ]
             },
             meeth_reaction_to_adam_gentle_check: { // Placeholder - needs to be developed with Meeth's reactions
                text: (gs) => `Meethexep has responded to your gentle check-in about his happiness with Niki. [This scene needs to be developed to include different possible reactions from Meethexep: enthusiastic reassurance, slight hesitation, defensiveness, expressing doubts, etc. Each reaction leads to a different branch of the story.] His response will give you insight into his true feelings and the stability of his relationship with Niki.`,
                choices: [
                    { text: "Analyze Meethexep's response and decide your next move...", nextScene: "adam_analyze_meeth_check_response" } // Scene for analysis and decision
                ]
             },
             adam_analyze_meeth_check_response: { // Placeholder - needs to be developed with analysis and decisions
                 text: (gs) => `You are analyzing Meethexep's response to your gentle check-in, trying to decipher his true feelings about Niki. [This scene needs to be expanded to provide guidance on interpreting different types of responses from Meethexep (enthusiastic, hesitant, etc.) and suggest different courses of action for AdamMady based on those interpretations. For now, it's a placeholder.] Your analysis will guide your next steps in supporting Meethexep (or perhaps starting to question things yourself).`,
                 choices: [
                     { text: "Decide on your next action based on your analysis of Meethexep's response...", nextScene: "adam_decide_action_after_check" } // Scene for decision and action
                 ]
             },
             adam_decide_action_after_check: { // Placeholder - needs to be developed with action choices
                 text: (gs) => `Based on your analysis of Meethexep's response to your gentle check-in, you are now deciding on your next action. [This scene needs to be expanded to include different action choices for AdamMady based on his analysis of Meethexep's response. For example: if Meeth was enthusiastic, Adam might continue full support; if hesitant, Adam might start to have doubts or probe further. For now, it's a placeholder.] Your chosen action will influence the future direction of the story.`,
                 choices: [
                     { text: "Proceed with your chosen action...", nextScene: "adam_action_after_check_continues" } // Placeholder for action execution
                 ]
             },
             adam_action_after_check_continues: { // Placeholder - needs to be developed with action consequences
                 text: (gs) => `You proceed with your chosen action, based on your analysis of Meethexep's response to your gentle check-in. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes.`,
                 choices: [
                     { text: "Continue the story...", nextScene: "..." } // Placeholder for further story progression
                 ]
             },


            // === BERISHBAEV SCENES ENDINGS ===
            beri_ask_voice: {
                text: (gs) => `You decide to ask a pointed question directly in the group chat: "Has anyone actually *heard* Choco~Niki's voice yet? Or seen her on video?" You cut straight to the core issue, bypassing AdamMady's enthusiasm and forcing the group to confront the lack of verifiable communication.`,
                choices: [
                    { text: "Wait for the group's reaction to your pointed question.", nextScene: "beri_wait_group_voice_question_response" }
                ]
            },
            beri_wait_group_voice_question_response: {
                text: (gs) => `You've asked the pointed question about voice or video contact with Choco~Niki in the group chat. Now, you wait for the reaction. Will AdamMady become defensive? Will Meethexep offer excuses? Will HappyMan try to mediate? Or will your question create a moment of uncomfortable silence as they realize the implications? The group's response will set the tone for the conversation.`,
                choices: [
                    { text: "Observe the group's reaction to your voice/video question.", nextScene: "group_reaction_to_beri_voice_question" } // Scene for group reaction (needs to be created)
                ]
            },
            group_reaction_to_beri_voice_question: { // Placeholder - needs to be developed with group reactions
                text: (gs) => `The group reacts to your pointed question about voice or video contact with Choco~Niki. [This scene needs to be developed to include different possible reactions from AdamMady (defensive), Meethexep (excuses), HappyMan (mediation), and potentially even Choco~Niki if she's observing. Each reaction leads to a different branch of the story.] The group's response will determine the immediate direction of the conversation.`,
                choices: [
                    { text: "Analyze the group's reaction and decide your next move.", nextScene: "beri_analyze_group_voice_response" } // Scene for analysis and decision
                ]
            },
            beri_analyze_group_voice_response: { // Placeholder - needs to be developed with analysis and decision
                text: (gs) => `You are analyzing the group's reaction to your question about voice/video contact, trying to assess their defensiveness, evasiveness, or openness to your point. [This scene needs to be expanded to provide guidance on interpreting different types of group responses and suggest different courses of action for Berishbaev based on those interpretations. For now, it's a placeholder.] Your analysis will inform your next step in pursuing your skepticism.`,
                choices: [
                    { text: "Decide on your next action based on your analysis of the group's response.", nextScene: "beri_decide_action_voice_response" } // Scene for decision and action
                ]
            },
            beri_decide_action_voice_response: { // Placeholder - needs to be developed with action choices
                text: (gs) => `Based on your analysis of the group's reaction to your voice/video question, you are now deciding on your next action. [This scene needs to be expanded to include different action choices for Berishbaev based on his analysis. For example: if they were defensive, Beri might become more direct; if they seemed open, Beri might offer more subtle guidance. For now, it's a placeholder.] Your chosen action will shape the direction of the conversation and your pursuit of the truth.`,
                choices: [
                    { text: "Proceed with your chosen action.", nextScene: "beri_action_voice_response_continues" } // Scene for action execution
                ]
            },
            beri_action_voice_response_continues: { // Placeholder - needs to be developed with action consequences
                text: (gs) => `You proceed with your chosen action, based on your analysis of the group's reaction to your voice/video question. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes.`,
                choices: [
                    { text: "Continue the story...", nextScene: "..." } // Placeholder for further story progression
                ]
            },
            beri_observe_early: {
                text: (gs) => `You decide to hold back for now and simply observe the situation. You monitor the group chat, paying attention to any further mentions of Choco~Niki, any inconsistencies in Meethexep's stories, and any reactions from AdamMady and HappyMan. You're gathering information before making your move.`,
                choices: [
                    { text: "Continue observing and gathering information.", nextScene: "beri_continue_observing" }
                ]
            },
            beri_continue_observing: {
                text: (gs) => `You continue to observe the group dynamic and Meethexep's relationship with Choco~Niki, looking for red flags and inconsistencies. You might notice patterns in their interactions, subtle clues in their messages, or growing defensiveness from Meethexep when Niki is questioned. You're building your case through careful observation.`,
                choices: [
                    { text: "Your observations lead you to consider intervening more directly...", nextScene: "beri_consider_direct_intervention" }
                ]
            },
            beri_consider_direct_intervention: {
                text: (gs) => `Your observations have strengthened your suspicions. You feel you can't just stand by and watch Meethexep potentially get hurt. You start considering more direct ways to intervene and make him (and possibly AdamMady) see the red flags you've noticed.`,
                choices: [
                    { text: "Decide to intervene more directly.", nextScene: "beri_decide_direct_intervention_method" }
                ]
            },
            beri_decide_direct_intervention_method: {
                text: (gs) => `You've decided to intervene more directly. Now you need to choose your method. Will you confront Meethexep privately? Will you raise your concerns more forcefully in the group chat? Will you try to gather more concrete evidence first? Your choice will determine the nature of your intervention.`,
                choices: [
                    { text: "Confront Meethexep privately.", nextScene: "beri_confront_meeth_private" },
                    { text: "Raise concerns more forcefully in the group chat.", nextScene: "beri_raise_concerns_group_chat_forcefully" },
                    { text: "Gather more concrete evidence first.", nextScene: "beri_gather_more_evidence" }
                ]
            },
            beri_confront_meeth_private: {
                text: (gs) => `You decide to confront Meethexep privately. You message him directly, expressing your concerns about Choco~Niki and wanting to have an honest conversation with him, away from AdamMady's potentially dismissive reactions. You aim for a calm and serious discussion.`,
                choices: [
                    { text: "Initiate a private conversation with Meethexep about your concerns.", nextScene: "beri_initiate_private_meeth_confrontation" }
                ]
            },
            beri_initiate_private_meeth_confrontation: {
                text: (gs) => `You've initiated a private conversation with Meethexep, intending to confront him with your concerns about Choco~Niki in a calm and direct manner. Now, you wait for his response. Will he be receptive to your concerns in private? Will he become defensive even without AdamMady's influence? Or will he finally be willing to listen to your perspective? His reaction will determine the direction of your private intervention.`,
                choices: [
                    { text: "See Meethexep's response to your private confrontation.", nextScene: "meeth_reaction_to_beri_private_confrontation" } // Scene for Meeth's reaction (needs to be created)
                ]
            },
            beri_raise_concerns_group_chat_forcefully: {
                text: (gs) => `You decide to raise your concerns more forcefully in the group chat. You plan to be more direct and explicit about your suspicions, presenting your observations and red flags clearly and demanding that Meethexep (and AdamMady) consider them seriously. You're ready to create a more direct confrontation in the group setting.`,
                choices: [
                    { text: "Raise your concerns forcefully in the group chat.", nextScene: "beri_raise_concerns_forcefully_group" }
                ]
            },
            beri_raise_concerns_forcefully_group: {
                text: (gs) => `You've chosen to raise your concerns more forcefully in the group chat. You type out a direct message outlining your suspicions about Choco~Niki, listing the red flags you've observed, and urging Meethexep and AdamMady to consider the possibility of deception. You send the message, bracing yourself for the likely explosive reaction.`,
                choices: [
                    { text: "Wait for the group's reaction to your forceful concerns.", nextScene: "group_reaction_to_beri_forceful_concerns" } // Scene for group reaction (needs to be created)
                ]
            },
            group_reaction_to_beri_forceful_concerns: { // Placeholder - needs to be developed with group reactions
                text: (gs) => `The group reacts to your forceful and direct expression of concerns about Choco~Niki. [This scene needs to be developed to include different possible reactions from Meethexep (shock, defensiveness, wavering), AdamMady (outrage, denial), and HappyMan (mediation attempt). Each reaction leads to a different branch of the story.] The group's response will determine the immediate aftermath of your forceful intervention.`,
                choices: [
                    { text: "Analyze the group's reaction and decide your next move.", nextScene: "beri_analyze_group_forceful_response" } // Scene for analysis and decision
                ]
            },
            beri_analyze_group_forceful_response: { // Placeholder - needs to be developed with analysis and decision
                text: (gs) => `You are analyzing the group's reaction to your forceful concerns, trying to gauge the level of resistance, defensiveness, or potential openness to your perspective. [This scene needs to be expanded to provide guidance on interpreting different types of group responses and suggest different courses of action for Berishbaev based on those interpretations. For now, it's a placeholder.] Your analysis will inform your next step in pursuing your intervention.`,
                choices: [
                    { text: "Decide on your next action based on your analysis of the group's response.", nextScene: "beri_decide_action_forceful_response" } // Scene for decision and action
                ]
            },
            beri_decide_action_forceful_response: { // Placeholder - needs to be developed with action choices
                text: (gs) => `Based on your analysis of the group's reaction to your forceful concerns, you are now deciding on your next action. [This scene needs to be expanded to include different action choices for Berishbaev based on his analysis. For example: if they were completely dismissive, Beri might escalate further; if they showed some wavering, Beri might try a more nuanced approach. For now, it's a placeholder.] Your chosen action will shape the ongoing confrontation.`,
                choices: [
                    { text: "Proceed with your chosen action.", nextScene: "beri_action_forceful_response_continues" } // Scene for action execution
                ]
            },
            beri_action_forceful_response_continues: { // Placeholder - needs to be developed with action consequences
                text: (gs) => `You proceed with your chosen action, based on your analysis of the group's reaction to your forceful concerns. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes.`,
                choices: [
                    { text: "Continue the story...", nextScene: "..." } // Placeholder for further story progression
                ]
            },
            beri_gather_more_evidence: {
                text: (gs) => `You decide that before directly confronting Meethexep or the group, you want to gather more concrete evidence to support your suspicions. You might consider reverse image searching Niki's profile pictures, looking for inconsistencies in her online presence, or trying to find any verifiable information about her claimed identity. You aim to build a stronger case before making your move.`,
                choices: [
                    { text: "Start gathering more evidence.", nextScene: "beri_start_gathering_evidence_process" }
                ]
            },
            beri_start_gathering_evidence_process: { // Placeholder - needs to be developed with evidence gathering actions
                text: (gs) => `You begin the process of gathering more evidence to support your suspicions about Choco~Niki. [This scene needs to be expanded to include specific actions the player can take (e.g., reverse image search, social media checks, etc.) and the potential outcomes of those actions (finding evidence, dead ends, etc.). For now, it's a placeholder.] You are now actively seeking proof to strengthen your case.`,
                choices: [
                    { text: "Continue gathering evidence...", nextScene: "beri_evidence_gathering_continues" } // Placeholder for evidence gathering continuation
                ]
            },
            beri_evidence_gathering_continues: { // Placeholder - needs to be developed with evidence gathering outcomes
                text: (gs) => `You continue your efforts to gather more evidence about Choco~Niki. [This scene and subsequent scenes need to be developed to reflect the results of the player's evidence gathering actions. Did you find anything conclusive? Inconclusive? Did you hit a dead end? The story branches here based on the outcome of the evidence gathering.] The results of your investigation will determine your next steps.`,
                choices: [
                    { text: "Evaluate the evidence you've gathered and decide your next move.", nextScene: "beri_evaluate_evidence_decide_next" } // Scene for evidence evaluation and decision
                ]
            },
            beri_evaluate_evidence_decide_next: { // Placeholder - needs to be developed with evidence evaluation and decisions
                text: (gs) => `You are evaluating the evidence you've gathered about Choco~Niki. [This scene needs to be expanded to provide guidance on interpreting different types of evidence (or lack thereof) and suggest different courses of action for Berishbaev based on the evaluation. For now, it's a placeholder.] Your evaluation will inform your decision on how to proceed with your intervention.`,
                choices: [
                    { text: "Decide on your next action based on your evidence evaluation.", nextScene: "beri_decide_action_evidence_evaluation" } // Scene for decision and action
                ]
            },
            beri_decide_action_evidence_evaluation: { // Placeholder - needs to be developed with action choices based on evidence
                text: (gs) => `Based on your evaluation of the evidence you've gathered, you are now deciding on your next action. [This scene needs to be expanded to include different action choices for Berishbaev based on his evidence evaluation. For example: if he found strong evidence, Beri might confront Niki directly; if evidence is weak, Beri might take a more cautious approach. For now, it's a placeholder.] Your chosen action will shape the direction of your intervention.`,
                choices: [
                    { text: "Proceed with your chosen action.", nextScene: "beri_action_evidence_evaluation_continues" } // Scene for action execution
                ]
            },
            beri_action_evidence_evaluation_continues: { // Placeholder - needs to be developed with action consequences
                text: (gs) => `You proceed with your chosen action, based on your evaluation of the evidence you've gathered. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes.`,
                choices: [
                    { text: "Continue the story...", nextScene: "..." } // Placeholder for further story progression
                ]
            },


            // === HAPPYMAN SCENES ENDINGS ===
            happy_pm_meeth: {
                text: (gs) => `You decide to privately message Meethexep. "Hey Meeth, how's it *really* going with Niki? You seem happy, which is great, but just wanted to check in. Online stuff can be tricky sometimes, you know?" You offer a gentle, private space for Meethexep to share any potential concerns without feeling judged by AdamMady's enthusiasm or Berishbaev's skepticism.`,
                choices: [
                    { text: "Wait for Meethexep's response to your private message.", nextScene: "happy_wait_meeth_pm_response" }
                ]
            },
            happy_wait_meeth_pm_response: {
                text: (gs) => `You've sent a private message to Meethexep, gently checking in on his relationship with Niki and offering a safe space to share any concerns. Now, you wait for his response. Will he open up to you about any doubts? Will he brush off your concerns and insist everything is fine? Or will he appreciate your check-in and engage in an honest conversation? His reply will guide your next steps in mediating the situation.`,
                choices: [
                    { text: "See Meethexep's response to your private message.", nextScene: "meeth_reaction_to_happy_pm" } // Scene for Meethexep's reaction (needs to be created)
                ]
            },
            happy_observe_early: {
                text: (gs) => `You decide to stay quiet in the group chat for now and just observe the dynamic between AdamMady and Berishbaev, and any reactions from Meethexep. You want to get a better sense of the current tension level and see if the situation escalates further before you intervene.`,
                choices: [
                    { text: "Continue observing the group chat.", nextScene: "happy_continue_observing_group" }
                ]
            },
            happy_continue_observing_group: {
                text: (gs) => `You continue to observe the group chat, watching AdamMady and Berishbaev clash, and noting Meethexep's reactions and any attempts to mediate by others. You're trying to assess the situation and identify the best moment and approach for your intervention.`,
                choices: [
                    { text: "Your observations lead you to consider intervening.", nextScene: "happy_consider_intervention" }
                ]
            },
            happy_consider_intervention: {
                text: (gs) => `Your observations of the group chat have convinced you that intervention is needed. The tension between AdamMady and Berishbaev is escalating, and Meethexep seems caught in the middle. You feel it's time to step in and try to de-escalate the conflict and guide the conversation towards a more constructive direction.`,
                choices: [
                    { text: "Decide to intervene in the group chat.", nextScene: "happy_decide_intervention_method" }
                ]
            },
            happy_decide_intervention_method: {
                text: (gs) => `You've decided to intervene in the group chat. Now you need to choose your method. Will you try to directly mediate the conflict between AdamMady and Berishbaev? Will you address Meethexep's situation directly? Will you try to de-escalate the tension with a general calming message? Your choice will determine the nature of your intervention.`,
                choices: [
                    { text: "Directly mediate between AdamMady and Berishbaev.", nextScene: "happy_mediate_adam_beri_directly" },
                    { text: "Address Meethexep's situation and well-being directly.", nextScene: "happy_address_meeth_situation_directly" },
                    { text: "Send a general de-escalating message to the group.", nextScene: "happy_deescalate_general_message" }
                ]
            },
            happy_mediate_adam_beri_directly: {
                text: (gs) => `You decide to directly mediate the conflict between AdamMady and Berishbaev. You address them both in the group chat, urging them to communicate more respectfully, listen to each other's perspectives, and focus on finding common ground rather than escalating the argument. You aim to be a neutral mediator, facilitating a more constructive dialogue.`,
                choices: [
                    { text: "Attempt to mediate directly between AdamMady and Berishbaev.", nextScene: "happy_attempt_mediate_adam_beri" }
                ]
            },
            happy_attempt_mediate_adam_beri: {
                text: (gs) => `You've attempted to directly mediate the conflict between AdamMady and Berishbaev, urging them to communicate more constructively. Now, you wait for their reactions. Will they be receptive to your mediation attempt? Will they tone down their conflict and engage in a more productive dialogue? Or will they dismiss your efforts and continue to clash? Their responses will determine the success of your mediation and the future direction of the group conversation.`,
                choices: [
                    { text: "Observe AdamMady and Berishbaev's reactions to your mediation attempt.", nextScene: "group_reaction_to_happy_mediation_adam_beri" } // Scene for group reaction (needs to be created)
                ]
            },
            group_reaction_to_happy_mediation_adam_beri: { // Placeholder - needs to be developed with group reactions
                text: (gs) => `AdamMady and Berishbaev react to your attempt to mediate their conflict. [This scene needs to be developed to include different possible reactions from AdamMady (receptive, dismissive, accusatory), Berishbaev (receptive, dismissive, resigned), and potentially Meethexep (relief, passivity). Each reaction leads to a different branch of the story.] The group's response will determine the immediate outcome of your mediation attempt.`,
                choices: [
                    { text: "Analyze AdamMady and Berishbaev's reactions and decide your next move.", nextScene: "happy_analyze_group_mediation_response" } // Scene for analysis and decision
                ]
            },
            happy_analyze_group_mediation_response: { // Placeholder - needs to be developed with analysis and decision
                text: (gs) => `You are analyzing AdamMady and Berishbaev's reactions to your mediation attempt, trying to assess whether your efforts have been successful in de-escalating the conflict and promoting constructive communication. [This scene needs to be expanded to provide guidance on interpreting different types of group responses and suggest different courses of action for HappyMan based on those interpretations. For now, it's a placeholder.] Your analysis will inform your next step in managing the group dynamic.`,
                choices: [
                    { text: "Decide on your next action based on your analysis of the group's response to mediation.", nextScene: "happy_decide_action_mediation_response" } // Scene for decision and action
                ]
            },
            happy_decide_action_mediation_response: { // Placeholder - needs to be developed with action choices
                text: (gs) => `Based on your analysis of AdamMady and Berishbaev's reactions to your mediation attempt, you are now deciding on your next action. [This scene needs to be expanded to include different action choices for HappyMan based on his analysis. For example: if they were receptive, HappyMan might encourage further constructive dialogue; if dismissive, HappyMan might try a different mediation tactic. For now, it's a placeholder.] Your chosen action will shape the future of the group conversation.`,
                choices: [
                    { text: "Proceed with your chosen action.", nextScene: "happy_action_mediation_response_continues" } // Scene for action execution
                ]
            },
            happy_action_mediation_response_continues: { // Placeholder - needs to be developed with action consequences
                text: (gs) => `You proceed with your chosen action, based on your analysis of the group's reaction to your mediation attempt. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes.`,
                choices: [
                    { text: "Continue the story...", nextScene: "..." } // Placeholder for further story progression
                ]
            },
            happy_address_meeth_situation_directly: {
                text: (gs) => `You decide to address Meethexep's situation directly in the group chat. You steer the conversation towards his relationship with Choco~Niki, gently acknowledging Berishbaev's concerns while also emphasizing the importance of supporting Meethexep and understanding his perspective. You aim to create a space for open and honest discussion about the situation, focusing on Meethexep's well-being.`,
                choices: [
                    { text: "Address Meethexep's situation directly in the group chat.", nextScene: "happy_address_meeth_situation_group" }
                ]
            },
            happy_address_meeth_situation_group: {
                text: (gs) => `You've chosen to address Meethexep's situation directly in the group chat. You type out a message that gently acknowledges Berishbaev's concerns while emphasizing the need to support Meethexep and understand his perspective. You send the message, hoping to shift the conversation towards a more constructive and empathetic direction, focused on Meethexep's well-being.`,
                choices: [
                    { text: "Wait for the group's reaction to your message addressing Meethexep's situation.", nextScene: "group_reaction_to_happy_meeth_address" } // Scene for group reaction (needs to be created)
                ]
            },
            group_reaction_to_happy_meeth_address: { // Placeholder - needs to be developed with group reactions
                text: (gs) => `The group reacts to your message directly addressing Meethexep's situation with Choco~Niki. [This scene needs to be developed to include different possible reactions from Meethexep (appreciation, defensiveness, silence), AdamMady (supportive of Meeth, dismissive of Berishbaev), and Berishbaev (acknowledging your attempt at balance, reiterating concerns). Each reaction leads to a different branch of the story.] The group's response will determine the immediate direction of the conversation.`,
                choices: [
                    { text: "Analyze the group's reaction and decide your next move.", nextScene: "happy_analyze_group_meeth_address_response" } // Scene for analysis and decision
                ]
            },
            happy_analyze_group_meeth_address_response: { // Placeholder - needs to be developed with analysis and decision
                text: (gs) => `You are analyzing the group's reaction to your message addressing Meethexep's situation, trying to assess whether your attempt to shift the conversation towards a more constructive and empathetic direction has been successful. [This scene needs to be expanded to provide guidance on interpreting different types of group responses and suggest different courses of action for HappyMan based on those interpretations. For now, it's a placeholder.] Your analysis will inform your next step in guiding the group dynamic.`,
                choices: [
                    { text: "Decide on your next action based on your analysis of the group's response to your message.", nextScene: "happy_decide_action_meeth_address_response" } // Scene for decision and action
                ]
            },
            happy_decide_action_meeth_address_response: { // Placeholder - needs to be developed with action choices
                text: (gs) => `Based on your analysis of the group's reaction to your message addressing Meethexep's situation, you are now deciding on your next action. [This scene needs to be expanded to include different action choices for HappyMan based on his analysis. For example: if they were receptive, HappyMan might encourage further open discussion; if dismissive or defensive, HappyMan might try a different approach. For now, it's a placeholder.] Your chosen action will shape the future of the conversation and your efforts to support Meethexep.`,
                choices: [
                    { text: "Proceed with your chosen action.", nextScene: "happy_action_meeth_address_response_continues" } // Scene for action execution
                ]
            },
            happy_action_meeth_address_response_continues: { // Placeholder - needs to be developed with action consequences
                text: (gs) => `You proceed with your chosen action, based on your analysis of the group's reaction to your message addressing Meethexep's situation. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes.`,
                choices: [
                    { text: "Continue the story...", nextScene: "..." } // Placeholder for further story progression
                ]
            },
            happy_deescalate_general_message: {
                text: (gs) => `You decide to send a general de-escalating message to the group chat, without directly addressing the conflict between AdamMady and Berishbaev or Meethexep's situation specifically. You aim to lower the tension level and create a more relaxed atmosphere, hoping to prevent further escalation and allow for a calmer conversation later. You might send a lighthearted message or change the topic entirely.`,
                choices: [
                    { text: "Send a general de-escalating message to the group.", nextScene: "happy_send_general_deescalation_message" }
                ]
            },
            happy_send_general_deescalation_message: {
                text: (gs) => `You've chosen to send a general de-escalating message to the group chat, aiming to lower the tension and create a more relaxed atmosphere. You type out a lighthearted message, perhaps changing the subject or making a joke, and send it to the group, hoping to diffuse the conflict and allow for a calmer conversation later on.`,
                choices: [
                    { text: "Wait for the group's reaction to your de-escalating message.", nextScene: "group_reaction_to_happy_deescalation" } // Scene for group reaction (needs to be created)
                ]
            },
            group_reaction_to_happy_deescalation: { // Placeholder - needs to be developed with group reactions
                text: (gs) => `The group reacts to your general de-escalating message. [This scene needs to be developed to include different possible reactions from AdamMady (ignoring it, going along with it, being annoyed), Berishbaev (ignoring it, reluctantly going along), and Meethexep (relief, passivity). Each reaction leads to a different branch of the story.] The group's response will determine whether your de-escalation attempt is successful in shifting the mood.`,
                choices: [
                    { text: "Analyze the group's reaction and decide your next move.", nextScene: "happy_analyze_group_deescalation_response" } // Scene for analysis and decision
                ]
            },
            happy_analyze_group_deescalation_response: { // Placeholder - needs to be developed with analysis and decision
                text: (gs) => `You are analyzing the group's reaction to your de-escalating message, trying to assess whether it has been effective in lowering the tension and creating a more relaxed atmosphere. [This scene needs to be expanded to provide guidance on interpreting different types of group responses and suggest different courses of action for HappyMan based on those interpretations. For now, it's a placeholder.] Your analysis will inform your next step in managing the group dynamic.`,
                choices: [
                    { text: "Decide on your next action based on your analysis of the group's response to de-escalation.", nextScene: "happy_decide_action_deescalation_response" } // Scene for decision and action
                ]
            },
            happy_decide_action_deescalation_response: { // Placeholder - needs to be developed with action choices
                text: (gs) => `Based on your analysis of the group's reaction to your de-escalating message, you are now deciding on your next action. [This scene needs to be expanded to include different action choices for HappyMan based on his analysis. For example: if they were receptive, HappyMan might try to steer the conversation to a safer topic; if they ignored it, HappyMan might need to try a more direct approach later. For now, it's a placeholder.] Your chosen action will shape the future of the group interaction.`,
                choices: [
                    { text: "Proceed with your chosen action.", nextScene: "happy_action_deescalation_response_continues" } // Scene for action execution
                ]
            },
            happy_action_deescalation_response_continues: { // Placeholder - needs to be developed with action consequences
                text: (gs) => `You proceed with your chosen action, based on your analysis of the group's reaction to your de-escalating message. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes.`,
                choices: [
                    { text: "Continue the story...", nextScene: "..." } // Placeholder for further story progression
                ]
            },
            meeth_reaction_to_niki_adam_poison: { // Placeholder - needs to be developed with Meeth's reactions
                text: (gs) => `Meethexep has reacted to Niki's subtle 'poison' message about AdamMady. [This scene needs to be developed to include different possible reactions from Meethexep: agreeing with Niki, defending Adam, dismissing Niki's comment, becoming confused, etc. Each reaction leads to a different branch of the story.] His response will reveal how effective Niki's manipulation tactic is.`,
                choices: [
                    { text: "Analyze Meethexep's reaction and decide your next move (as Niki).", nextScene: "niki_analyze_meeth_adam_poison_response" } // Scene for Niki's analysis and decision
                ]
            },
            niki_analyze_meeth_adam_poison_response: { // Placeholder - needs to be developed with analysis and decisions for Niki
                text: (gs) => `You are analyzing Meethexep's reaction to your 'poison' message about AdamMady, trying to assess whether he is buying into your manipulation and starting to doubt his friendship with Adam. [This scene needs to be expanded to provide guidance on interpreting different types of responses from Meethexep and suggest different courses of action for Niki based on those interpretations. For now, it's a placeholder.] Your analysis will inform your next step in isolating Meethexep from his friends.`,
                choices: [
                    { text: "Decide on your next action based on your analysis of Meethexep's response (as Niki).", nextScene: "niki_decide_action_adam_poison_response" } // Scene for Niki's decision and action
                ]
            },
            niki_decide_action_adam_poison_response: { // Placeholder - needs to be developed with action choices for Niki
                text: (gs) => `Based on your analysis of Meethexep's reaction to your 'poison' message about AdamMady, you are now deciding on your next action as Niki. [This scene needs to be expanded to include different action choices for Niki based on her analysis. For example: if Meeth agreed with her, Niki might push further to isolate him from Adam; if he defended Adam, Niki might try a different manipulation tactic. For now, it's a placeholder.] Your chosen action will shape your strategy to control Meethexep's relationships.`,
                choices: [
                    { text: "Proceed with your chosen action (as Niki).", nextScene: "niki_action_adam_poison_response_continues" } // Scene for Niki's action execution
                ]
            },
            niki_action_adam_poison_response_continues: { // Placeholder - needs to be developed with action consequences for Niki
                text: (gs) => `You proceed with your chosen action as Niki, based on your analysis of Meethexep's reaction to your 'poison' message about AdamMady. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences from Niki's perspective. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes, as you continue to manipulate Meethexep and his friendships.`,
                choices: [
                    { text: "Continue the story (as Niki)...", nextScene: "..." } // Placeholder for further story progression from Niki's perspective
                ]
            },
            meeth_reaction_to_niki_beri_poison: { // Placeholder - needs to be developed with Meeth's reactions
                text: (gs) => `Meethexep has reacted to Niki's 'poison' message about Berishbaev. [This scene needs to be developed to include different possible reactions from Meethexep: agreeing with Niki, defending Berishbaev, dismissing Niki's comment, becoming conflicted, etc. Each reaction leads to a different branch of the story.] His response will reveal how effective Niki's manipulation tactic is in turning him against Berishbaev.`,
                choices: [
                    { text: "Analyze Meethexep's reaction and decide your next move (as Niki).", nextScene: "niki_analyze_meeth_beri_poison_response" } // Scene for Niki's analysis and decision
                ]
            },
            niki_analyze_meeth_beri_poison_response: { // Placeholder - needs to be developed with analysis and decisions for Niki
                text: (gs) => `You are analyzing Meethexep's reaction to your 'poison' message about Berishbaev, trying to assess whether he is buying into your manipulation and starting to distrust Berishbaev's concerns. [This scene needs to be expanded to provide guidance on interpreting different types of responses from Meethexep and suggest different courses of action for Niki based on those interpretations. For now, it's a placeholder.] Your analysis will inform your next step in undermining Berishbaev's influence.`,
                choices: [
                    { text: "Decide on your next action based on your analysis of Meethexep's response (as Niki).", nextScene: "niki_decide_action_beri_poison_response" } // Scene for Niki's decision and action
                ]
            },
            niki_decide_action_beri_poison_response: { // Placeholder - needs to be developed with action choices for Niki
                text: (gs) => `Based on your analysis of Meethexep's reaction to your 'poison' message about Berishbaev, you are now deciding on your next action as Niki. [This scene needs to be expanded to include different action choices for Niki based on her analysis. For example: if Meeth agreed with her, Niki might push further to isolate him from Berishbaev; if he defended Berishbaev, Niki might try a different manipulation tactic or escalate the conflict. For now, it's a placeholder.] Your chosen action will shape your strategy to neutralize Berishbaev as a threat.`,
                choices: [
                    { text: "Proceed with your chosen action (as Niki).", nextScene: "niki_action_beri_poison_response_continues" } // Scene for Niki's action execution
                ]
            },
            niki_action_beri_poison_response_continues: { // Placeholder - needs to be developed with action consequences for Niki
                text: (gs) => `You proceed with your chosen action as Niki, based on your analysis of Meethexep's reaction to your 'poison' message about Berishbaev. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences from Niki's perspective. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes, as you continue to manipulate Meethexep's perception of Berishbaev.`,
                choices: [
                    { text: "Continue the story (as Niki)...", nextScene: "..." } // Placeholder for further story progression from Niki's perspective
                ]
            },
            meeth_reaction_to_niki_victim_play: { // Placeholder - needs to be developed with Meeth's reactions
                text: (gs) => `Meethexep has reacted to your 'victim play' message, expressing hurt and confusion at Berishbaev's accusations. [This scene needs to be developed to include different possible reactions from Meethexep: rushing to reassure Niki, expressing guilt, defending Niki against Berishbaev, showing slight hesitation, etc. Each reaction leads to a different branch of the story.] His response will reveal how effective your victim manipulation tactic is.`,
                choices: [
                    { text: "Analyze Meethexep's reaction and decide your next move (as Niki).", nextScene: "niki_analyze_meeth_victim_response" } // Scene for Niki's analysis and decision
                ]
            },
            niki_analyze_meeth_victim_response: { // Placeholder - needs to be developed with analysis and decisions for Niki
                text: (gs) => `You are analyzing Meethexep's reaction to your victim play, trying to assess whether he is falling for your manipulation and rushing to comfort and reassure you. [This scene needs to be expanded to provide guidance on interpreting different types of responses from Meethexep and suggest different courses of action for Niki based on those interpretations. For now, it's a placeholder.] Your analysis will inform your next step in solidifying Meethexep's trust and sympathy.`,
                choices: [
                    { text: "Decide on your next action based on your analysis of Meethexep's response (as Niki).", nextScene: "niki_decide_action_victim_response" } // Scene for Niki's decision and action
                ]
            },
            niki_decide_action_victim_response: { // Placeholder - needs to be developed with action choices for Niki
                text: (gs) => `Based on your analysis of Meethexep's reaction to your victim play, you are now deciding on your next action as Niki. [This scene needs to be expanded to include different action choices for Niki based on her analysis. For example: if Meeth rushed to reassure her, Niki might further exploit his sympathy; if he showed hesitation, Niki might escalate the emotional manipulation. For now, it's a placeholder.] Your chosen action will shape your strategy to maintain control through emotional manipulation.`,
                choices: [
                    { text: "Proceed with your chosen action (as Niki).", nextScene: "niki_action_victim_response_continues" } // Scene for Niki's action execution
                ]
            },
            niki_action_victim_response_continues: { // Placeholder - needs to be developed with action consequences for Niki
                text: (gs) => `You proceed with your chosen action as Niki, based on your analysis of Meethexep's reaction to your victim play. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences from Niki's perspective. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes, as you continue to manipulate Meethexep's emotions and maintain control.`,
                choices: [
                    { text: "Continue the story (as Niki)...", nextScene: "..." } // Placeholder for further story progression from Niki's perspective
                ]
            },
            meeth_reaction_to_niki_blame_beri: { // Placeholder - needs to be developed with Meeth's reactions
                text: (gs) => `Meethexep has reacted to your message blaming Berishbaev for causing trouble and urging him to distrust Berishbaev's motives. [This scene needs to be developed to include different possible reactions from Meethexep: agreeing with Niki, defending Berishbaev, dismissing Niki's comment, becoming conflicted, etc. Each reaction leads to a different branch of the story.] His response will reveal how effective your blame-shifting tactic is in turning him against Berishbaev.`,
                choices: [
                    { text: "Analyze Meethexep's reaction and decide your next move (as Niki).", nextScene: "niki_analyze_meeth_blame_beri_response" } // Scene for Niki's analysis and decision
                ]
            },
            niki_analyze_meeth_blame_beri_response: { // Placeholder - needs to be developed with analysis and decisions for Niki
                text: (gs) => `You are analyzing Meethexep's reaction to your message blaming Berishbaev, trying to assess whether he is buying into your attempt to discredit Berishbaev and turn him into the 'villain'. [This scene needs to be expanded to provide guidance on interpreting different types of responses from Meethexep and suggest different courses of action for Niki based on those interpretations. For now, it's a placeholder.] Your analysis will inform your next step in isolating Meethexep from Berishbaev's influence.`,
                choices: [
                    { text: "Decide on your next action based on your analysis of Meethexep's response (as Niki).", nextScene: "niki_decide_action_blame_beri_response" } // Scene for Niki's decision and action
                ]
            },
            niki_decide_action_blame_beri_response: { // Placeholder - needs to be developed with action choices for Niki
                text: (gs) => `Based on your analysis of Meethexep's reaction to your message blaming Berishbaev, you are now deciding on your next action as Niki. [This scene needs to be expanded to include different action choices for Niki based on her analysis. For example: if Meeth agreed with her, Niki might push further to solidify his distrust of Berishbaev; if he defended Berishbaev, Niki might try a different manipulation tactic or escalate the conflict. For now, it's a placeholder.] Your chosen action will shape your strategy to neutralize Berishbaev as a threat by turning Meethexep against him.`,
                choices: [
                    { text: "Proceed with your chosen action (as Niki).", nextScene: "niki_action_blame_beri_response_continues" } // Scene for Niki's action execution
                ]
            },
            niki_action_blame_beri_response_continues: { // Placeholder - needs to be developed with action consequences for Niki
                text: (gs) => `You proceed with your chosen action as Niki, based on your analysis of Meethexep's reaction to your message blaming Berishbaev. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences from Niki's perspective. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes, as you continue to manipulate Meethexep's perception of Berishbaev and solidify your control.`,
                choices: [
                    { text: "Continue the story (as Niki)...", nextScene: "..." } // Placeholder for further story progression from Niki's perspective
                ]
            },
            meeth_reaction_to_happy_pm: { // Placeholder - needs to be developed with Meeth's reactions
                text: (gs) => `Meethexep has responded to your private message checking in on him and his relationship with Niki. [This scene needs to be developed to include different possible reactions from Meethexep: openness and sharing doubts, defensiveness and insisting everything is fine, appreciation for your concern but no real sharing, etc. Each reaction leads to a different branch of the story.] His response will reveal his true feelings and his willingness to confide in you.`,
                choices: [
                    { text: "Analyze Meethexep's response and decide your next move (as HappyMan).", nextScene: "happy_analyze_meeth_pm_response" } // Scene for HappyMan's analysis and decision
                ]
            },
            happy_analyze_meeth_pm_response: { // Placeholder - needs to be developed with analysis and decisions for HappyMan
                text: (gs) => `You are analyzing Meethexep's response to your private check-in, trying to assess whether he has been open and honest with you about his feelings and any potential doubts about Niki. [This scene needs to be expanded to provide guidance on interpreting different types of responses from Meethexep and suggest different courses of action for HappyMan based on those interpretations. For now, it's a placeholder.] Your analysis will inform your next step in supporting Meethexep and mediating the situation.`,
                choices: [
                    { text: "Decide on your next action based on your analysis of Meethexep's response (as HappyMan).", nextScene: "happy_decide_action_pm_response" } // Scene for HappyMan's decision and action
                ]
            },
            happy_decide_action_pm_response: { // Placeholder - needs to be developed with action choices for HappyMan
                text: (gs) => `Based on your analysis of Meethexep's response to your private check-in, you are now deciding on your next action as HappyMan. [This scene needs to be expanded to include different action choices for HappyMan based on his analysis. For example: if Meeth opened up, HappyMan might offer further support and guidance; if he was defensive, HappyMan might need to try a different approach or respect his boundaries for now. For now, it's a placeholder.] Your chosen action will shape your strategy to support Meethexep and mediate the situation constructively.`,
                choices: [
                    { text: "Proceed with your chosen action (as HappyMan).", nextScene: "happy_action_pm_response_continues" } // Scene for HappyMan's action execution
                ]
            },
            happy_action_pm_response_continues: { // Placeholder - needs to be developed with action consequences for HappyMan
                text: (gs) => `You proceed with your chosen action as HappyMan, based on your analysis of Meethexep's response to your private check-in. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences from HappyMan's perspective. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes, as you continue to try and mediate the situation and support Meethexep.`,
                choices: [
                    { text: "Continue the story (as HappyMan)...", nextScene: "..." } // Placeholder for further story progression from HappyMan's perspective
                ]
            },
            meeth_reaction_to_beri_private_confrontation: { // Placeholder - needs to be developed with Meeth's reactions
                text: (gs) => `Meethexep has responded to your private confrontation about Choco~Niki. [This scene needs to be developed to include different possible reactions from Meethexep: defensiveness, openness to listen, asking for proof, admitting some doubts, etc. Each reaction leads to a different branch of the story.] His response will determine the success of your private intervention.`,
                choices: [
                    { text: "Analyze Meethexep's reaction and decide your next move (as Berishbaev).", nextScene: "beri_analyze_meeth_private_response" } // Scene for Berishbaev's analysis and decision
                ]
            },
            beri_analyze_meeth_private_response: { // Placeholder - needs to be developed with analysis and decisions for Berishbaev
                text: (gs) => `You are analyzing Meethexep's reaction to your private confrontation, trying to assess whether he is receptive to your concerns or resistant and defensive. [This scene needs to be expanded to provide guidance on interpreting different types of responses from Meethexep and suggest different courses of action for Berishbaev based on those interpretations. For now, it's a placeholder.] Your analysis will inform your next step in your private intervention.`,
                choices: [
                    { text: "Decide on your next action based on your analysis of Meethexep's response (as Berishbaev).", nextScene: "beri_decide_action_private_response" } // Scene for Berishbaev's decision and action
                ]
            },
            beri_decide_action_private_response: { // Placeholder - needs to be developed with action choices for Berishbaev
                text: (gs) => `Based on your analysis of Meethexep's reaction to your private confrontation, you are now deciding on your next action as Berishbaev. [This scene needs to be expanded to include different action choices for Berishbaev based on his analysis. For example: if Meeth was receptive, Beri might offer more evidence or advice; if he was defensive, Beri might need to try a different approach or back off for now. For now, it's a placeholder.] Your chosen action will shape the direction of your private intervention.`,
                choices: [
                    { text: "Proceed with your chosen action (as Berishbaev).", nextScene: "beri_action_private_response_continues" } // Scene for Berishbaev's action execution
                ]
            },
            beri_action_private_response_continues: { // Placeholder - needs to be developed with action consequences for Berishbaev
                text: (gs) => `You proceed with your chosen action as Berishbaev, based on your analysis of Meethexep's reaction to your private confrontation. [This scene and subsequent scenes need to be developed to reflect the specific actions chosen by the player and the evolving consequences from Berishbaev's perspective. The story branches here depending on the chosen path.] The impact of your action will unfold in the following scenes, as you continue your private intervention to help Meethexep.`,
                choices: [
                    { text: "Continue the story (as Berishbaev)...", nextScene: "..." } // Placeholder for further story progression from Berishbaev's perspective
                ]
            },
             meeth_reaction_to_beri_question: story.meeth_reaction_to_question, // Reusing existing scene
             adam_reaction_to_question: story.adam_reaction_to_question, // Reusing existing scene
             beri_observe_fallout: story.beri_observe_fallout, // Reusing existing scene
             happy_reaction_to_question: story.happy_reaction_to_question, // Reusing existing scene
             niki_reaction_to_question: story.niki_reaction_to_question, // Reusing existing scene
             END: story.END // Reusing existing scene
        };


        // --- GAME LOGIC ---
        function $(selector) {
            return document.querySelector(selector);
        }

        function selectCharacter(charKey) {
            gameState.character = charKey;
            gameState.currentScene = characters[charKey].startScene;
            gameState.flags = {}; // Reset flags

            $("#character-selection").style.display = 'none';
            $("#game-content").style.display = 'block';
            $("#ending-screen").style.display = 'none';
            $("#character-name").innerHTML = `<span class="char-icon">${characters[charKey].icon}</span> Playing as ${characters[charKey].name}`;

            displayScene(gameState.currentScene);
            // Highlight selected button (optional visual feedback)
            document.querySelectorAll('.character-button').forEach(btn => {
                if(btn.textContent.includes(characters[charKey].name)) {
                    btn.classList.add('selected');
                } else {
                    btn.classList.remove('selected');
                }
            });
        }

        function displayScene(sceneId) {
            if (sceneId === "END") {
                // Should be handled by choices leading to ending scenes
                console.error("Reached END scene directly");
                return;
            }

            const scene = story[sceneId];
            if (!scene) {
                console.error(`Scene not found: ${sceneId}`);
                 $("#story-text").innerHTML = `Error: Scene "${sceneId}" not found. Please restart.`;
                 $("#choices").innerHTML = '';
                return;
            }

            // Update story text - check if it's a function
             const textContent = typeof scene.text === 'function' ? scene.text(gameState) : scene.text;
             $("#story-text").innerHTML = textContent;

            // Update choices
            const choicesContainer = $("#choices");
            choicesContainer.innerHTML = ''; // Clear old choices

            if (scene.choices && scene.choices.length > 0) {
                scene.choices.forEach((choice, index) => {
                    // Check condition if it exists
                    if (choice.condition && !choice.condition(gameState)) {
                        return; // Skip this choice if condition not met
                    }

                    const button = document.createElement('button');
                    button.classList.add('choice-button');
                    button.textContent = choice.text;
                    button.onclick = () => makeChoice(choice);
                    choicesContainer.appendChild(button);
                });
            } else if (!story[scene.nextScene]) { // Check if it leads to an ending defined directly
                 console.warn(`Scene ${sceneId} has no choices and no nextScene defined.`);
                 // Maybe add a default "Continue?" if appropriate, or assume it's an ending point.
            }
        }

        function makeChoice(choice) {
             // Apply flags if any
             if (choice.setFlag) {
                for (const flag in choice.setFlag) {
                    gameState.flags[flag] = choice.setFlag[flag];
                }
             }

             // Determine next scene
             let nextSceneId = null;
             if (typeof choice.nextScene === 'function') {
                 nextSceneId = choice.nextScene(gameState);
             } else {
                 nextSceneId = choice.nextScene;
             }


            if (nextSceneId && story[nextSceneId] && story[nextSceneId].choices && story[nextSceneId].choices.length === 1 && story[nextSceneId].choices[0].text === "The End.") {
                 // This is an ending scene
                 displayEnding(nextSceneId);
            } else if (nextSceneId === "END") {
                 // Allow direct END transition for simplicity in some cases
                 $("#game-content").style.display = 'none';
                 $("#ending-screen").style.display = 'block';
                 $("#ending-text").innerHTML = "The story concludes here based on your choices."; // Generic end
            }
             else if (nextSceneId) {
                 gameState.currentScene = nextSceneId;
                 displayScene(gameState.currentScene);
             } else {
                 console.error("Choice leads nowhere:", choice);
                 $("#story-text").innerHTML += "<br><br><i>Error: This choice path is incomplete.</i>";
             }
        }

        function displayEnding(sceneId) {
             const scene = story[sceneId];
             const endingContent = typeof scene.text === 'function' ? scene.text(gameState) : scene.text;

             $("#game-content").style.display = 'none';
             $("#ending-screen").style.display = 'block';
             $("#ending-text").innerHTML = endingContent;
        }


        function restartGame() {
            gameState = { character: null, currentScene: null, flags: {} };
            $("#character-selection").style.display = 'block';
            $("#game-content").style.display = 'none';
            $("#ending-screen").style.display = 'none';
             document.querySelectorAll('.character-button').forEach(btn => btn.classList.remove('selected'));
        }

        // Initial setup - Show character selection
        $("#character-selection").style.display = 'block';
        $("#game-content").style.display = 'none';
        $("#ending-screen").style.display = 'none';

        // --- INITIAL GAME START SCENE ---
        gameState.currentScene = "shared_intro"; // Start with the shared intro scene
        displayScene(gameState.currentScene);

    </script>

</body>
</html>